63 6f 6e 73 74 20 7b 20  61 70 70 2c 20 42 72 6f
77 73 65 72 57 69 6e 64  6f 77 2c 20 64 69 61 6c
6f 67 2c 20 73 68 65 6c  6c 2c 20 69 70 63 4d 61
69 6e 20 7d 20 3d 20 72  65 71 75 69 72 65 28 27
65 6c 65 63 74 72 6f 6e  27 29 3b 0d 0a 63 6f 6e
73 74 20 70 61 74 68 20  3d 20 72 65 71 75 69 72
65 28 27 70 61 74 68 27  29 3b 0d 0a 63 6f 6e 73
74 20 7b 20 66 6f 72 6b  2c 20 73 70 61 77 6e 20
7d 20 3d 20 72 65 71 75  69 72 65 28 27 63 68 69
6c 64 5f 70 72 6f 63 65  73 73 27 29 3b 0d 0a 63
6f 6e 73 74 20 66 73 20  3d 20 72 65 71 75 69 72
65 28 27 66 73 27 29 3b  0d 0a 63 6f 6e 73 74 20
6f 73 20 3d 20 72 65 71  75 69 72 65 28 27 6f 73
27 29 3b 0d 0a 0d 0a 2f  2f 20 53 68 61 72 65 64
20 6c 6f 67 20 66 69 6c  65 20 77 72 69 74 74 65
6e 20 62 79 20 61 6c 6c  20 6d 61 6e 61 67 65 64
20 73 65 72 76 69 63 65  73 20 28 65 78 63 65 70
74 20 27 61 70 70 27 20  77 68 69 63 68 20 75 73
65 73 20 69 74 73 20 50  79 74 68 6f 6e 20 46 69
6c 65 48 61 6e 64 6c 65  72 29 0d 0a 63 6f 6e 73
74 20 5f 4c 4f 47 5f 44  49 52 20 3d 20 70 61 74
68 2e 6a 6f 69 6e 28 70  72 6f 63 65 73 73 2e 65
6e 76 2e 41 50 50 44 41  54 41 20 7c 7c 20 70 61
74 68 2e 6a 6f 69 6e 28  6f 73 2e 68 6f 6d 65 64
69 72 28 29 2c 20 27 2e  63 6f 6e 66 69 67 27 29
2c 20 27 70 73 69 2d 61  69 2d 63 6f 6e 74 65 6e
74 2d 68 75 62 27 2c 20  27 6c 6f 67 73 27 29 3b
0d 0a 63 6f 6e 73 74 20  5f 4c 4f 47 5f 46 49 4c
45 20 3d 20 70 61 74 68  2e 6a 6f 69 6e 28 5f 4c
4f 47 5f 44 49 52 2c 20  27 61 70 70 2d 73 65 72
76 69 63 65 2e 6c 6f 67  27 29 3b 0d 0a 63 6f 6e
73 74 20 5f 4c 4f 47 5f  4d 41 58 5f 42 59 54 45
53 20 3d 20 31 30 20 2a  20 31 30 32 34 20 2a 20
31 30 32 34 3b 20 2f 2f  20 31 30 20 4d 42 0d 0a
0d 0a 66 75 6e 63 74 69  6f 6e 20 61 70 70 65 6e
64 54 6f 53 65 72 76 69  63 65 4c 6f 67 28 73 65
72 76 69 63 65 49 64 2c  20 74 65 78 74 29 20 7b
0d 0a 20 20 74 72 79 20  7b 0d 0a 20 20 20 20 69
66 20 28 21 66 73 2e 65  78 69 73 74 73 53 79 6e
63 28 5f 4c 4f 47 5f 44  49 52 29 29 20 66 73 2e
6d 6b 64 69 72 53 79 6e  63 28 5f 4c 4f 47 5f 44
49 52 2c 20 7b 20 72 65  63 75 72 73 69 76 65 3a
20 74 72 75 65 20 7d 29  3b 0d 0a 20 20 20 20 74
72 79 20 7b 0d 0a 20 20  20 20 20 20 69 66 20 28
66 73 2e 65 78 69 73 74  73 53 79 6e 63 28 5f 4c
4f 47 5f 46 49 4c 45 29  20 26 26 20 66 73 2e 73
74 61 74 53 79 6e 63 28  5f 4c 4f 47 5f 46 49 4c
45 29 2e 73 69 7a 65 20  3e 20 5f 4c 4f 47 5f 4d
41 58 5f 42 59 54 45 53  29 20 7b 0d 0a 20 20 20
20 20 20 20 20 66 73 2e  75 6e 6c 69 6e 6b 53 79
6e 63 28 5f 4c 4f 47 5f  46 49 4c 45 29 3b 0d 0a
20 20 20 20 20 20 7d 0d  0a 20 20 20 20 7d 20 63
61 74 63 68 20 28 5f 29  20 7b 7d 0d 0a 20 20 20
20 63 6f 6e 73 74 20 74  73 20 3d 20 6e 65 77 20
44 61 74 65 28 29 2e 74  6f 49 53 4f 53 74 72 69
6e 67 28 29 2e 72 65 70  6c 61 63 65 28 27 54 27
2c 20 27 20 27 29 2e 73  6c 69 63 65 28 30 2c 20
31 39 29 3b 0d 0a 20 20  20 20 63 6f 6e 73 74 20
6c 69 6e 65 73 20 3d 20  74 65 78 74 2e 73 70 6c
69 74 28 27 5c 6e 27 29  2e 66 69 6c 74 65 72 28
28 6c 29 20 3d 3e 20 6c  2e 74 72 69 6d 28 29 29
3b 0d 0a 20 20 20 20 63  6f 6e 73 74 20 6f 75 74
20 3d 20 6c 69 6e 65 73  2e 6d 61 70 28 28 6c 29
20 3d 3e 20 60 24 7b 74  73 7d 20 5b 24 7b 73 65
72 76 69 63 65 49 64 7d  5d 20 24 7b 6c 7d 60 29
2e 6a 6f 69 6e 28 27 5c  6e 27 29 20 2b 20 27 5c
6e 27 3b 0d 0a 20 20 20  20 66 73 2e 61 70 70 65
6e 64 46 69 6c 65 53 79  6e 63 28 5f 4c 4f 47 5f
46 49 4c 45 2c 20 6f 75  74 2c 20 27 75 74 66 38
27 29 3b 0d 0a 20 20 7d  20 63 61 74 63 68 20 28
5f 29 20 7b 7d 0d 0a 7d  0d 0a 0d 0a 6c 65 74 20
6d 61 69 6e 57 69 6e 64  6f 77 3b 0d 0a 6c 65 74
20 73 65 72 76 65 72 50  72 6f 63 65 73 73 3b 0d
0a 6c 65 74 20 76 6f 69  63 65 43 6c 6f 6e 65 53
65 72 76 65 72 50 72 6f  63 65 73 73 3b 0d 0a 6c
65 74 20 74 74 73 46 61  73 74 53 65 72 76 65 72
50 72 6f 63 65 73 73 3b  0d 0a 6c 65 74 20 69 70
63 43 6c 69 65 6e 74 20  3d 20 6e 75 6c 6c 3b 0d
0a 6c 65 74 20 70 65 6e  64 69 6e 67 52 65 71 75
65 73 74 73 20 3d 20 6e  65 77 20 4d 61 70 28 29
3b 0d 0a 6c 65 74 20 72  65 71 75 65 73 74 49 64
20 3d 20 30 3b 0d 0a 63  6f 6e 73 74 20 6d 61 6e
61 67 65 64 53 65 72 76  69 63 65 50 72 6f 63 65
73 73 65 73 20 3d 20 6e  65 77 20 4d 61 70 28 29
3b 0d 0a 63 6f 6e 73 74  20 6d 61 6e 61 67 65 64
53 65 72 76 69 63 65 52  75 6e 74 69 6d 65 20 3d
20 6e 65 77 20 4d 61 70  28 29 3b 0d 0a 0d 0a 63
6f 6e 73 74 20 4d 41 4e  41 47 45 44 5f 53 45 52
56 49 43 45 53 20 3d 20  5b 0d 0a 20 20 7b 0d 0a
20 20 20 20 69 64 3a 20  27 61 70 70 27 2c 0d 0a
20 20 20 20 6e 61 6d 65  3a 20 27 41 70 70 20 41
50 49 27 2c 0d 0a 20 20  20 20 72 65 6c 61 74 69
76 65 52 6f 6f 74 3a 20  70 61 74 68 2e 6a 6f 69
6e 28 27 70 79 74 68 6f  6e 5f 61 70 69 27 2c 20
27 61 70 70 2d 61 6e 64  2d 62 61 73 69 63 2d 74
6f 6f 6c 27 29 2c 0d 0a  20 20 20 20 65 6e 74 72
79 4d 6f 64 75 6c 65 3a  20 27 61 70 70 2e 6d 61
69 6e 27 2c 0d 0a 20 20  20 20 61 70 69 55 72 6c
3a 20 27 68 74 74 70 3a  2f 2f 31 32 37 2e 30 2e
30 2e 31 3a 36 39 30 31  27 2c 0d 0a 20 20 7d 2c
0d 0a 20 20 7b 0d 0a 20  20 20 20 69 64 3a 20 27
69 6d 61 67 65 66 69 6e  64 65 72 27 2c 0d 0a 20
20 20 20 6e 61 6d 65 3a  20 27 49 6d 61 67 65 20
46 69 6e 64 65 72 20 41  50 49 27 2c 0d 0a 20 20
20 20 72 65 6c 61 74 69  76 65 52 6f 6f 74 3a 20
70 61 74 68 2e 6a 6f 69  6e 28 27 70 79 74 68 6f
6e 5f 61 70 69 27 2c 20  27 49 6d 61 67 65 46 69
6e 64 65 72 27 29 2c 0d  0a 20 20 20 20 65 6e 74
72 79 4d 6f 64 75 6c 65  3a 20 27 61 70 70 2e 6d
61 69 6e 27 2c 0d 0a 20  20 20 20 61 70 69 55 72
6c 3a 20 27 68 74 74 70  3a 2f 2f 31 32 37 2e 30
2e 30 2e 31 3a 36 39 30  37 27 2c 0d 0a 20 20 20
20 62 6f 6f 74 73 74 72  61 70 50 61 63 6b 61 67
65 73 3a 20 5b 27 66 61  73 74 61 70 69 27 2c 20
27 75 76 69 63 6f 72 6e  27 2c 20 27 70 79 74 68
6f 6e 2d 6d 75 6c 74 69  70 61 72 74 27 2c 20 27
50 69 6c 6c 6f 77 27 2c  20 27 72 65 71 75 65 73
74 73 27 2c 20 27 68 74  74 70 78 27 5d 2c 0d 0a
20 20 7d 2c 0d 0a 20 20  7b 0d 0a 20 20 20 20 69
64 3a 20 27 74 72 61 6e  73 6c 61 74 69 6f 6e 27
2c 0d 0a 20 20 20 20 6e  61 6d 65 3a 20 27 54 72
61 6e 73 6c 61 74 69 6f  6e 20 41 50 49 27 2c 0d
0a 20 20 20 20 72 65 6c  61 74 69 76 65 52 6f 6f
74 3a 20 70 61 74 68 2e  6a 6f 69 6e 28 27 70 79
74 68 6f 6e 5f 61 70 69  27 2c 20 27 54 72 61 6e
73 6c 61 74 69 6f 6e 27  29 2c 0d 0a 20 20 20 20
65 6e 74 72 79 4d 6f 64  75 6c 65 3a 20 27 61 70
70 2e 6d 61 69 6e 27 2c  0d 0a 20 20 20 20 61 70
69 55 72 6c 3a 20 27 68  74 74 70 3a 2f 2f 31 32
37 2e 30 2e 30 2e 31 3a  36 39 30 36 27 2c 0d 0a
20 20 7d 2c 0d 0a 20 20  7b 0d 0a 20 20 20 20 69
64 3a 20 27 66 35 27 2c  0d 0a 20 20 20 20 6e 61
6d 65 3a 20 27 46 35 20  56 6f 69 63 65 20 43 6c
6f 6e 65 20 41 50 49 27  2c 0d 0a 20 20 20 20 72
65 6c 61 74 69 76 65 52  6f 6f 74 3a 20 70 61 74
68 2e 6a 6f 69 6e 28 27  70 79 74 68 6f 6e 5f 61
70 69 27 2c 20 27 46 35  2d 54 54 53 27 29 2c 0d
0a 20 20 20 20 65 6e 74  72 79 4d 6f 64 75 6c 65
3a 20 27 61 70 70 2e 6d  61 69 6e 27 2c 0d 0a 20
20 20 20 61 70 69 55 72  6c 3a 20 27 68 74 74 70
3a 2f 2f 31 32 37 2e 30  2e 30 2e 31 3a 36 39 30
32 27 2c 0d 0a 20 20 7d  2c 0d 0a 20 20 7b 0d 0a
20 20 20 20 69 64 3a 20  27 76 69 65 6e 65 75 27
2c 0d 0a 20 20 20 20 6e  61 6d 65 3a 20 27 56 69
65 4e 65 75 20 54 54 53  20 41 50 49 27 2c 0d 0a
20 20 20 20 72 65 6c 61  74 69 76 65 52 6f 6f 74
3a 20 70 61 74 68 2e 6a  6f 69 6e 28 27 70 79 74
68 6f 6e 5f 61 70 69 27  2c 20 27 56 69 65 4e 65
75 2d 54 54 53 27 29 2c  0d 0a 20 20 20 20 65 6e
74 72 79 4d 6f 64 75 6c  65 3a 20 27 61 70 70 2e
6d 61 69 6e 27 2c 0d 0a  20 20 20 20 61 70 69 55
72 6c 3a 20 27 68 74 74  70 3a 2f 2f 31 32 37 2e
30 2e 30 2e 31 3a 36 39  30 33 27 2c 0d 0a 20 20
7d 2c 0d 0a 20 20 7b 0d  0a 20 20 20 20 69 64 3a
20 27 77 68 69 73 70 65  72 27 2c 0d 0a 20 20 20
20 6e 61 6d 65 3a 20 27  57 68 69 73 70 65 72 20
53 54 54 20 41 50 49 27  2c 0d 0a 20 20 20 20 72
65 6c 61 74 69 76 65 52  6f 6f 74 3a 20 70 61 74
68 2e 6a 6f 69 6e 28 27  70 79 74 68 6f 6e 5f 61
70 69 27 2c 20 27 77 68  69 73 70 65 72 2d 73 74
74 27 29 2c 0d 0a 20 20  20 20 65 6e 74 72 79 4d
6f 64 75 6c 65 3a 20 27  61 70 70 2e 6d 61 69 6e
27 2c 0d 0a 20 20 20 20  61 70 69 55 72 6c 3a 20
27 68 74 74 70 3a 2f 2f  31 32 37 2e 30 2e 30 2e
31 3a 36 39 30 34 27 2c  0d 0a 20 20 7d 2c 0d 0a
20 20 7b 0d 0a 20 20 20  20 69 64 3a 20 27 62 67
72 65 6d 6f 76 65 27 2c  0d 0a 20 20 20 20 6e 61
6d 65 3a 20 27 42 61 63  6b 67 72 6f 75 6e 64 20
52 65 6d 6f 76 61 6c 20  41 50 49 27 2c 0d 0a 20
20 20 20 72 65 6c 61 74  69 76 65 52 6f 6f 74 3a
20 70 61 74 68 2e 6a 6f  69 6e 28 27 70 79 74 68
6f 6e 5f 61 70 69 27 2c  20 27 62 67 2d 72 65 6d
6f 76 65 2d 6f 76 65 72  6c 61 79 27 29 2c 0d 0a
20 20 20 20 65 6e 74 72  79 4d 6f 64 75 6c 65 3a
20 27 61 70 70 2e 6d 61  69 6e 27 2c 0d 0a 20 20
20 20 61 70 69 55 72 6c  3a 20 27 68 74 74 70 3a
2f 2f 31 32 37 2e 30 2e  30 2e 31 3a 36 39 30 35
27 2c 0d 0a 20 20 20 20  73 74 61 72 74 75 70 54
69 6d 65 6f 75 74 4d 73  3a 20 36 30 30 30 30 2c
0d 0a 20 20 7d 2c 0d 0a  5d 3b 0d 0a 0d 0a 63 6f
6e 73 74 20 42 4f 4f 54  53 54 52 41 50 5f 50 41
43 4b 41 47 45 53 20 3d  20 7b 0d 0a 20 20 61 70
70 3a 20 5b 0d 0a 20 20  20 20 27 66 61 73 74 61
70 69 27 2c 20 27 75 76  69 63 6f 72 6e 27 2c 20
27 70 79 74 68 6f 6e 2d  6d 75 6c 74 69 70 61 72
74 27 2c 0d 0a 20 20 20  20 27 50 69 6c 6c 6f 77
27 2c 20 27 72 65 71 75  65 73 74 73 27 2c 20 27
68 74 74 70 78 27 2c 0d  0a 20 20 20 20 27 65 64
67 65 2d 74 74 73 27 2c  0d 0a 20 20 20 20 27 64
64 67 73 27 2c 20 20 20  20 20 20 20 20 20 20 20
20 20 20 20 20 20 20 20  20 20 20 2f 2f 20 72 65
70 6c 61 63 65 73 20 64  75 63 6b 64 75 63 6b 67
6f 5f 73 65 61 72 63 68  0d 0a 20 20 20 20 27 75
6e 64 65 74 65 63 74 65  64 2d 63 68 72 6f 6d 65
64 72 69 76 65 72 27 2c  20 20 20 2f 2f 20 72 65
70 6c 61 63 65 73 20 73  65 6c 65 6e 69 75 6d 20
2b 20 77 65 62 64 72 69  76 65 72 2d 6d 61 6e 61
67 65 72 2c 20 61 75 74  6f 2d 6d 61 6e 61 67 65
73 20 43 68 72 6f 6d 65  44 72 69 76 65 72 0d 0a
20 20 5d 2c 0d 0a 20 20  69 6d 61 67 65 66 69 6e
64 65 72 3a 20 5b 0d 0a  20 20 20 20 27 66 61 73
74 61 70 69 27 2c 20 27  75 76 69 63 6f 72 6e 27
2c 20 27 70 79 74 68 6f  6e 2d 6d 75 6c 74 69 70
61 72 74 27 2c 0d 0a 20  20 20 20 27 50 69 6c 6c
6f 77 27 2c 20 27 72 65  71 75 65 73 74 73 27 2c
20 27 68 74 74 70 78 27  2c 0d 0a 20 20 20 20 27
64 64 67 73 27 2c 20 20  20 20 20 20 20 20 20 20
20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 72
65 70 6c 61 63 65 73 20  64 75 63 6b 64 75 63 6b
67 6f 5f 73 65 61 72 63  68 0d 0a 20 20 20 20 27
75 6e 64 65 74 65 63 74  65 64 2d 63 68 72 6f 6d
65 64 72 69 76 65 72 27  2c 20 20 20 2f 2f 20 72
65 70 6c 61 63 65 73 20  73 65 6c 65 6e 69 75 6d
20 2b 20 77 65 62 64 72  69 76 65 72 2d 6d 61 6e
61 67 65 72 2c 20 61 75  74 6f 2d 6d 61 6e 61 67
65 73 20 43 68 72 6f 6d  65 44 72 69 76 65 72 0d
0a 20 20 5d 2c 0d 0a 20  20 74 72 61 6e 73 6c 61
74 69 6f 6e 3a 20 5b 0d  0a 20 20 20 20 27 66 61
73 74 61 70 69 27 2c 20  27 75 76 69 63 6f 72 6e
27 2c 20 27 70 79 74 68  6f 6e 2d 6d 75 6c 74 69
70 61 72 74 27 2c 0d 0a  20 20 20 20 27 50 69 6c
6c 6f 77 27 2c 20 27 72  65 71 75 65 73 74 73 27
2c 20 27 68 74 74 70 78  27 2c 0d 0a 20 20 20 20
27 64 64 67 73 27 2c 20  20 20 20 20 20 20 20 20
20 20 20 20 20 20 20 20  20 20 20 20 20 2f 2f 20
72 65 70 6c 61 63 65 73  20 64 75 63 6b 64 75 63
6b 67 6f 5f 73 65 61 72  63 68 0d 0a 20 20 20 20
27 75 6e 64 65 74 65 63  74 65 64 2d 63 68 72 6f
6d 65 64 72 69 76 65 72  27 2c 20 20 20 2f 2f 20
72 65 70 6c 61 63 65 73  20 73 65 6c 65 6e 69 75
6d 20 2b 20 77 65 62 64  72 69 76 65 72 2d 6d 61
6e 61 67 65 72 2c 20 61  75 74 6f 2d 6d 61 6e 61
67 65 73 20 43 68 72 6f  6d 65 44 72 69 76 65 72
0d 0a 20 20 5d 2c 0d 0a  20 20 66 35 3a 20 5b 0d
0a 20 20 20 20 27 66 61  73 74 61 70 69 27 2c 20
27 75 76 69 63 6f 72 6e  27 2c 20 27 70 79 74 68
6f 6e 2d 6d 75 6c 74 69  70 61 72 74 27 2c 0d 0a
20 20 20 20 27 50 69 6c  6c 6f 77 27 2c 20 27 72
65 71 75 65 73 74 73 27  2c 20 27 68 74 74 70 78
27 2c 0d 0a 20 20 20 20  27 64 64 67 73 27 2c 20
20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20
20 20 20 20 20 2f 2f 20  72 65 70 6c 61 63 65 73
20 64 75 63 6b 64 75 63  6b 67 6f 5f 73 65 61 72
63 68 0d 0a 20 20 20 20  27 75 6e 64 65 74 65 63
74 65 64 2d 63 68 72 6f  6d 65 64 72 69 76 65 72
27 2c 20 20 20 2f 2f 20  72 65 70 6c 61 63 65 73
20 73 65 6c 65 6e 69 75  6d 20 2b 20 77 65 62 64
72 69 76 65 72 2d 6d 61  6e 61 67 65 72 2c 20 61
75 74 6f 2d 6d 61 6e 61  67 65 73 20 43 68 72 6f
6d 65 44 72 69 76 65 72  0d 0a 20 20 5d 2c 0d 0a
20 20 76 69 65 6e 65 75  3a 20 5b 0d 0a 20 20 20
20 27 66 61 73 74 61 70  69 27 2c 20 27 75 76 69
63 6f 72 6e 27 2c 20 27  70 79 74 68 6f 6e 2d 6d
75 6c 74 69 70 61 72 74  27 2c 0d 0a 20 20 20 20
27 50 69 6c 6c 6f 77 27  2c 20 27 72 65 71 75 65
73 74 73 27 2c 20 27 68  74 74 70 78 27 2c 0d 0a
20 20 20 20 27 64 64 67  73 27 2c 20 20 20 20 20
20 20 20 20 20 20 20 20  20 20 20 20 20 20 20 20
20 2f 2f 20 72 65 70 6c  61 63 65 73 20 64 75 63
6b 64 75 63 6b 67 6f 5f  73 65 61 72 63 68 0d 0a
20 20 20 20 27 75 6e 64  65 74 65 63 74 65 64 2d
63 68 72 6f 6d 65 64 72  69 76 65 72 27 2c 20 20
20 2f 2f 20 72 65 70 6c  61 63 65 73 20 73 65 6c
65 6e 69 75 6d 20 2b 20  77 65 62 64 72 69 76 65
72 2d 6d 61 6e 61 67 65  72 2c 20 61 75 74 6f 2d
6d 61 6e 61 67 65 73 20  43 68 72 6f 6d 65 44 72
69 76 65 72 0d 0a 20 20  5d 2c 0d 0a 20 20 77 68
69 73 70 65 72 3a 20 5b  0d 0a 20 20 20 20 27 66
61 73 74 61 70 69 27 2c  20 27 75 76 69 63 6f 72
6e 27 2c 20 27 70 79 74  68 6f 6e 2d 6d 75 6c 74
69 70 61 72 74 27 2c 0d  0a 20 20 20 20 27 50 69
6c 6c 6f 77 27 2c 20 27  72 65 71 75 65 73 74 73
27 2c 20 27 68 74 74 70  78 27 2c 0d 0a 20 20 20
20 27 64 64 67 73 27 2c  20 20 20 20 20 20 20 20
20 20 20 20 20 20 20 20  20 20 20 20 20 20 2f 2f
20 72 65 70 6c 61 63 65  73 20 64 75 63 6b 64 75
63 6b 67 6f 5f 73 65 61  72 63 68 0d 0a 20 20 20
20 27 75 6e 64 65 74 65  63 74 65 64 2d 63 68 72
6f 6d 65 64 72 69 76 65  72 27 2c 20 20 20 2f 2f
20 72 65 70 6c 61 63 65  73 20 73 65 6c 65 6e 69
75 6d 20 2b 20 77 65 62  64 72 69 76 65 72 2d 6d
61 6e 61 67 65 72 2c 20  61 75 74 6f 2d 6d 61 6e
61 67 65 73 20 43 68 72  6f 6d 65 44 72 69 76 65
72 0d 0a 20 20 5d 2c 0d  0a 20 20 62 67 72 65 6d
6f 76 65 3a 20 5b 0d 0a  20 20 20 20 27 66 61 73
74 61 70 69 27 2c 20 27  75 76 69 63 6f 72 6e 27
2c 20 27 70 79 74 68 6f  6e 2d 6d 75 6c 74 69 70
61 72 74 27 2c 0d 0a 20  20 20 20 27 50 69 6c 6c
6f 77 27 2c 20 27 72 65  71 75 65 73 74 73 27 2c
20 27 68 74 74 70 78 27  2c 0d 0a 20 20 20 20 27
64 64 67 73 27 2c 20 20  20 20 20 20 20 20 20 20
20 20 20 20 20 20 20 20  20 20 20 20 2f 2f 20 72
65 70 6c 61 63 65 73 20  64 75 63 6b 64 75 63 6b
67 6f 5f 73 65 61 72 63  68 0d 0a 20 20 20 20 27
75 6e 64 65 74 65 63 74  65 64 2d 63 68 72 6f 6d
65 64 72 69 76 65 72 27  2c 20 20 20 2f 2f 20 72
65 70 6c 61 63 65 73 20  73 65 6c 65 6e 69 75 6d
20 2b 20 77 65 62 64 72  69 76 65 72 2d 6d 61 6e
61 67 65 72 2c 20 61 75  74 6f 2d 6d 61 6e 61 67
65 73 20 43 68 72 6f 6d  65 44 72 69 76 65 72 0d
0a 20 20 5d 2c 0d 0a 7d  3b 0d 0a 0d 0a 2f 2f 20
43 68 65 63 6b 20 69 66  20 64 65 76 20 73 65 72
76 65 72 20 69 73 20 72  75 6e 6e 69 6e 67 20 6f
6e 20 70 6f 72 74 20 35  30 30 30 0d 0a 63 6f 6e
73 74 20 69 73 44 65 76  20 3d 20 21 61 70 70 2e
69 73 50 61 63 6b 61 67  65 64 3b 0d 0a 0d 0a 66
75 6e 63 74 69 6f 6e 20  67 65 74 49 6e 73 74 61
6c 6c 44 69 72 28 29 20  7b 0d 0a 20 20 72 65 74
75 72 6e 20 61 70 70 2e  69 73 50 61 63 6b 61 67
65 64 20 3f 20 70 61 74  68 2e 64 69 72 6e 61 6d
65 28 70 72 6f 63 65 73  73 2e 65 78 65 63 50 61
74 68 29 20 3a 20 70 72  6f 63 65 73 73 2e 63 77
64 28 29 3b 0d 0a 7d 0d  0a 0d 0a 66 75 6e 63 74
69 6f 6e 20 67 65 74 50  72 6f 6a 65 63 74 52 6f
6f 74 28 29 20 7b 0d 0a  20 20 72 65 74 75 72 6e
20 61 70 70 2e 69 73 50  61 63 6b 61 67 65 64 20
3f 20 61 70 70 2e 67 65  74 41 70 70 50 61 74 68
28 29 20 3a 20 70 72 6f  63 65 73 73 2e 63 77 64
28 29 3b 0d 0a 7d 0d 0a  0d 0a 66 75 6e 63 74 69
6f 6e 20 67 65 74 4d 61  6e 61 67 65 64 53 65 72
76 69 63 65 43 6f 6e 66  69 67 28 73 65 72 76 69
63 65 49 64 29 20 7b 0d  0a 20 20 63 6f 6e 73 74
20 73 65 72 76 69 63 65  20 3d 20 4d 41 4e 41 47
45 44 5f 53 45 52 56 49  43 45 53 2e 66 69 6e 64
28 28 65 6e 74 72 79 29  20 3d 3e 20 65 6e 74 72
79 2e 69 64 20 3d 3d 3d  20 73 65 72 76 69 63 65
49 64 29 3b 0d 0a 20 20  69 66 20 28 21 73 65 72
76 69 63 65 29 20 72 65  74 75 72 6e 20 6e 75 6c
6c 3b 0d 0a 0d 0a 20 20  63 6f 6e 73 74 20 73 65
72 76 69 63 65 52 6f 6f  74 20 3d 20 70 61 74 68
2e 6a 6f 69 6e 28 67 65  74 50 72 6f 6a 65 63 74
52 6f 6f 74 28 29 2c 20  73 65 72 76 69 63 65 2e
72 65 6c 61 74 69 76 65  52 6f 6f 74 29 3b 0d 0a
20 20 63 6f 6e 73 74 20  76 65 6e 76 50 79 74 68
6f 6e 50 61 74 68 20 3d  20 70 72 6f 63 65 73 73
2e 70 6c 61 74 66 6f 72  6d 20 3d 3d 3d 20 27 77
69 6e 33 32 27 0d 0a 20  20 20 20 3f 20 70 61 74
68 2e 6a 6f 69 6e 28 73  65 72 76 69 63 65 52 6f
6f 74 2c 20 27 76 65 6e  76 27 2c 20 27 53 63 72
69 70 74 73 27 2c 20 27  70 79 74 68 6f 6e 2e 65
78 65 27 29 0d 0a 20 20  20 20 3a 20 70 61 74 68
2e 6a 6f 69 6e 28 73 65  72 76 69 63 65 52 6f 6f
74 2c 20 27 76 65 6e 76  27 2c 20 27 62 69 6e 27
2c 20 27 70 79 74 68 6f  6e 27 29 3b 0d 0a 0d 0a
20 20 72 65 74 75 72 6e  20 7b 0d 0a 20 20 20 20
2e 2e 2e 73 65 72 76 69  63 65 2c 0d 0a 20 20 20
20 73 65 72 76 69 63 65  52 6f 6f 74 2c 0d 0a 20
20 20 20 76 65 6e 76 50  79 74 68 6f 6e 50 61 74
68 2c 0d 0a 20 20 20 20  68 65 61 6c 74 68 55 72
6c 3a 20 60 24 7b 73 65  72 76 69 63 65 2e 61 70
69 55 72 6c 7d 2f 61 70  69 2f 76 31 2f 73 74 61
74 75 73 60 2c 0d 0a 20  20 7d 3b 0d 0a 7d 0d 0a
0d 0a 66 75 6e 63 74 69  6f 6e 20 67 65 74 49 6e
69 74 69 61 6c 4d 61 6e  61 67 65 64 53 65 72 76
69 63 65 52 75 6e 74 69  6d 65 28 73 65 72 76 69
63 65 49 64 29 20 7b 0d  0a 20 20 63 6f 6e 73 74
20 73 65 72 76 69 63 65  20 3d 20 67 65 74 4d 61
6e 61 67 65 64 53 65 72  76 69 63 65 43 6f 6e 66
69 67 28 73 65 72 76 69  63 65 49 64 29 3b 0d 0a
20 20 69 66 20 28 21 73  65 72 76 69 63 65 29 20
72 65 74 75 72 6e 20 6e  75 6c 6c 3b 0d 0a 0d 0a
20 20 63 6f 6e 73 74 20  63 6f 6e 66 69 67 75 72
65 64 20 3d 20 66 73 2e  65 78 69 73 74 73 53 79
6e 63 28 73 65 72 76 69  63 65 2e 76 65 6e 76 50
79 74 68 6f 6e 50 61 74  68 29 3b 0d 0a 20 20 72
65 74 75 72 6e 20 7b 0d  0a 20 20 20 20 73 74 61
74 75 73 3a 20 63 6f 6e  66 69 67 75 72 65 64 20
3f 20 27 73 74 6f 70 70  65 64 27 20 3a 20 27 6e
6f 74 5f 63 6f 6e 66 69  67 75 72 65 64 27 2c 0d
0a 20 20 20 20 70 69 64  3a 20 6e 75 6c 6c 2c 0d
0a 20 20 20 20 65 72 72  6f 72 3a 20 6e 75 6c 6c
2c 0d 0a 20 20 20 20 75  70 64 61 74 65 64 5f 61
74 3a 20 6e 65 77 20 44  61 74 65 28 29 2e 74 6f
49 53 4f 53 74 72 69 6e  67 28 29 2c 0d 0a 20 20
7d 3b 0d 0a 7d 0d 0a 0d  0a 66 75 6e 63 74 69 6f
6e 20 65 6e 73 75 72 65  4d 61 6e 61 67 65 64 53
65 72 76 69 63 65 52 75  6e 74 69 6d 65 28 73 65
72 76 69 63 65 49 64 29  20 7b 0d 0a 20 20 69 66
20 28 21 6d 61 6e 61 67  65 64 53 65 72 76 69 63
65 52 75 6e 74 69 6d 65  2e 68 61 73 28 73 65 72
76 69 63 65 49 64 29 29  20 7b 0d 0a 20 20 20 20
63 6f 6e 73 74 20 69 6e  69 74 69 61 6c 20 3d 20
67 65 74 49 6e 69 74 69  61 6c 4d 61 6e 61 67 65
64 53 65 72 76 69 63 65  52 75 6e 74 69 6d 65 28
73 65 72 76 69 63 65 49  64 29 3b 0d 0a 20 20 20
20 69 66 20 28 69 6e 69  74 69 61 6c 29 20 7b 0d
0a 20 20 20 20 20 20 6d  61 6e 61 67 65 64 53 65
72 76 69 63 65 52 75 6e  74 69 6d 65 2e 73 65 74
28 73 65 72 76 69 63 65  49 64 2c 20 69 6e 69 74
69 61 6c 29 3b 0d 0a 20  20 20 20 7d 0d 0a 20 20
7d 0d 0a 20 20 72 65 74  75 72 6e 20 6d 61 6e 61
67 65 64 53 65 72 76 69  63 65 52 75 6e 74 69 6d
65 2e 67 65 74 28 73 65  72 76 69 63 65 49 64 29
20 7c 7c 20 6e 75 6c 6c  3b 0d 0a 7d 0d 0a 0d 0a
66 75 6e 63 74 69 6f 6e  20 62 75 69 6c 64 4d 61
6e 61 67 65 64 53 65 72  76 69 63 65 53 74 61 74
75 73 28 73 65 72 76 69  63 65 49 64 29 20 7b 0d
0a 20 20 63 6f 6e 73 74  20 73 65 72 76 69 63 65
20 3d 20 67 65 74 4d 61  6e 61 67 65 64 53 65 72
76 69 63 65 43 6f 6e 66  69 67 28 73 65 72 76 69
63 65 49 64 29 3b 0d 0a  20 20 63 6f 6e 73 74 20
72 75 6e 74 69 6d 65 20  3d 20 65 6e 73 75 72 65
4d 61 6e 61 67 65 64 53  65 72 76 69 63 65 52 75
6e 74 69 6d 65 28 73 65  72 76 69 63 65 49 64 29
3b 0d 0a 20 20 69 66 20  28 21 73 65 72 76 69 63
65 20 7c 7c 20 21 72 75  6e 74 69 6d 65 29 20 72
65 74 75 72 6e 20 6e 75  6c 6c 3b 0d 0a 0d 0a 20
20 63 6f 6e 73 74 20 63  6f 6e 66 69 67 75 72 65
64 20 3d 20 66 73 2e 65  78 69 73 74 73 53 79 6e
63 28 73 65 72 76 69 63  65 2e 76 65 6e 76 50 79
74 68 6f 6e 50 61 74 68  29 3b 0d 0a 20 20 72 65
74 75 72 6e 20 7b 0d 0a  20 20 20 20 69 64 3a 20
73 65 72 76 69 63 65 2e  69 64 2c 0d 0a 20 20 20
20 6e 61 6d 65 3a 20 73  65 72 76 69 63 65 2e 6e
61 6d 65 2c 0d 0a 20 20  20 20 73 74 61 74 75 73
3a 20 63 6f 6e 66 69 67  75 72 65 64 20 26 26 20
72 75 6e 74 69 6d 65 2e  73 74 61 74 75 73 20 3d
3d 3d 20 27 6e 6f 74 5f  63 6f 6e 66 69 67 75 72
65 64 27 20 3f 20 27 73  74 6f 70 70 65 64 27 20
3a 20 72 75 6e 74 69 6d  65 2e 73 74 61 74 75 73
2c 0d 0a 20 20 20 20 70  69 64 3a 20 72 75 6e 74
69 6d 65 2e 70 69 64 2c  0d 0a 20 20 20 20 65 72
72 6f 72 3a 20 72 75 6e  74 69 6d 65 2e 65 72 72
6f 72 2c 0d 0a 20 20 20  20 61 70 69 5f 75 72 6c
3a 20 73 65 72 76 69 63  65 2e 61 70 69 55 72 6c
2c 0d 0a 20 20 20 20 68  65 61 6c 74 68 5f 75 72
6c 3a 20 73 65 72 76 69  63 65 2e 68 65 61 6c 74
68 55 72 6c 2c 0d 0a 20  20 20 20 73 65 72 76 69
63 65 5f 72 6f 6f 74 3a  20 73 65 72 76 69 63 65
2e 73 65 72 76 69 63 65  52 6f 6f 74 2c 0d 0a 20
20 20 20 76 65 6e 76 5f  70 79 74 68 6f 6e 5f 70
61 74 68 3a 20 73 65 72  76 69 63 65 2e 76 65 6e
76 50 79 74 68 6f 6e 50  61 74 68 2c 0d 0a 20 20
20 20 63 6f 6e 66 69 67  75 72 65 64 2c 0d 0a 20
20 20 20 75 70 64 61 74  65 64 5f 61 74 3a 20 72
75 6e 74 69 6d 65 2e 75  70 64 61 74 65 64 5f 61
74 2c 0d 0a 20 20 7d 3b  0d 0a 7d 0d 0a 0d 0a 66
75 6e 63 74 69 6f 6e 20  67 65 74 4d 61 6e 61 67
65 64 53 65 72 76 69 63  65 73 53 74 61 74 75 73
4c 69 73 74 28 29 20 7b  0d 0a 20 20 72 65 74 75
72 6e 20 4d 41 4e 41 47  45 44 5f 53 45 52 56 49
43 45 53 2e 6d 61 70 28  28 73 65 72 76 69 63 65
29 20 3d 3e 20 62 75 69  6c 64 4d 61 6e 61 67 65
64 53 65 72 76 69 63 65  53 74 61 74 75 73 28 73
65 72 76 69 63 65 2e 69  64 29 29 2e 66 69 6c 74
65 72 28 42 6f 6f 6c 65  61 6e 29 3b 0d 0a 7d 0d
0a 0d 0a 66 75 6e 63 74  69 6f 6e 20 62 72 6f 61
64 63 61 73 74 4d 61 6e  61 67 65 64 53 65 72 76
69 63 65 73 53 74 61 74  75 73 28 29 20 7b 0d 0a
20 20 69 66 20 28 6d 61  69 6e 57 69 6e 64 6f 77
20 26 26 20 21 6d 61 69  6e 57 69 6e 64 6f 77 2e
69 73 44 65 73 74 72 6f  79 65 64 28 29 29 20 7b
0d 0a 20 20 20 20 6d 61  69 6e 57 69 6e 64 6f 77
2e 77 65 62 43 6f 6e 74  65 6e 74 73 2e 73 65 6e
64 28 27 73 65 72 76 69  63 65 73 3a 73 74 61 74
75 73 2d 63 68 61 6e 67  65 64 27 2c 20 67 65 74
4d 61 6e 61 67 65 64 53  65 72 76 69 63 65 73 53
74 61 74 75 73 4c 69 73  74 28 29 29 3b 0d 0a 20
20 7d 0d 0a 7d 0d 0a 0d  0a 66 75 6e 63 74 69 6f
6e 20 73 65 74 4d 61 6e  61 67 65 64 53 65 72 76
69 63 65 52 75 6e 74 69  6d 65 28 73 65 72 76 69
63 65 49 64 2c 20 70 61  74 63 68 29 20 7b 0d 0a
20 20 63 6f 6e 73 74 20  63 75 72 72 65 6e 74 20
3d 20 65 6e 73 75 72 65  4d 61 6e 61 67 65 64 53
65 72 76 69 63 65 52 75  6e 74 69 6d 65 28 73 65
72 76 69 63 65 49 64 29  3b 0d 0a 20 20 69 66 20
28 21 63 75 72 72 65 6e  74 29 20 72 65 74 75 72
6e 20 6e 75 6c 6c 3b 0d  0a 0d 0a 20 20 63 6f 6e
73 74 20 6e 65 78 74 20  3d 20 7b 0d 0a 20 20 20
20 2e 2e 2e 63 75 72 72  65 6e 74 2c 0d 0a 20 20
20 20 2e 2e 2e 70 61 74  63 68 2c 0d 0a 20 20 20
20 75 70 64 61 74 65 64  5f 61 74 3a 20 6e 65 77
20 44 61 74 65 28 29 2e  74 6f 49 53 4f 53 74 72
69 6e 67 28 29 2c 0d 0a  20 20 7d 3b 0d 0a 20 20
6d 61 6e 61 67 65 64 53  65 72 76 69 63 65 52 75
6e 74 69 6d 65 2e 73 65  74 28 73 65 72 76 69 63
65 49 64 2c 20 6e 65 78  74 29 3b 0d 0a 20 20 62
72 6f 61 64 63 61 73 74  4d 61 6e 61 67 65 64 53
65 72 76 69 63 65 73 53  74 61 74 75 73 28 29 3b
0d 0a 20 20 72 65 74 75  72 6e 20 6e 65 78 74 3b
0d 0a 7d 0d 0a 0d 0a 66  75 6e 63 74 69 6f 6e 20
77 61 69 74 46 6f 72 50  72 6f 63 65 73 73 45 78
69 74 28 70 72 6f 63 65  73 73 48 61 6e 64 6c 65
2c 20 74 69 6d 65 6f 75  74 4d 73 29 20 7b 0d 0a
20 20 72 65 74 75 72 6e  20 6e 65 77 20 50 72 6f
6d 69 73 65 28 28 72 65  73 6f 6c 76 65 29 20 3d
3e 20 7b 0d 0a 20 20 20  20 6c 65 74 20 64 6f 6e
65 20 3d 20 66 61 6c 73  65 3b 0d 0a 20 20 20 20
63 6f 6e 73 74 20 66 69  6e 69 73 68 20 3d 20 28
76 61 6c 75 65 29 20 3d  3e 20 7b 0d 0a 20 20 20
20 20 20 69 66 20 28 64  6f 6e 65 29 20 72 65 74
75 72 6e 3b 0d 0a 20 20  20 20 20 20 64 6f 6e 65
20 3d 20 74 72 75 65 3b  0d 0a 20 20 20 20 20 20
72 65 73 6f 6c 76 65 28  76 61 6c 75 65 29 3b 0d
0a 20 20 20 20 7d 3b 0d  0a 0d 0a 20 20 20 20 70
72 6f 63 65 73 73 48 61  6e 64 6c 65 2e 6f 6e 63
65 28 27 65 78 69 74 27  2c 20 28 29 20 3d 3e 20
66 69 6e 69 73 68 28 74  72 75 65 29 29 3b 0d 0a
20 20 20 20 73 65 74 54  69 6d 65 6f 75 74 28 28
29 20 3d 3e 20 66 69 6e  69 73 68 28 66 61 6c 73
65 29 2c 20 74 69 6d 65  6f 75 74 4d 73 29 3b 0d
0a 20 20 7d 29 3b 0d 0a  7d 0d 0a 0d 0a 61 73 79
6e 63 20 66 75 6e 63 74  69 6f 6e 20 77 61 69 74
46 6f 72 4d 61 6e 61 67  65 64 53 65 72 76 69 63
65 52 65 61 64 79 28 73  65 72 76 69 63 65 49 64
2c 20 74 69 6d 65 6f 75  74 4d 73 20 3d 20 33 30
30 30 30 29 20 7b 0d 0a  20 20 63 6f 6e 73 74 20
73 65 72 76 69 63 65 20  3d 20 67 65 74 4d 61 6e
61 67 65 64 53 65 72 76  69 63 65 43 6f 6e 66 69
67 28 73 65 72 76 69 63  65 49 64 29 3b 0d 0a 20
20 69 66 20 28 21 73 65  72 76 69 63 65 29 20 72
65 74 75 72 6e 20 66 61  6c 73 65 3b 0d 0a 0d 0a
20 20 63 6f 6e 73 74 20  73 74 61 72 74 65 64 41
74 20 3d 20 44 61 74 65  2e 6e 6f 77 28 29 3b 0d
0a 20 20 77 68 69 6c 65  20 28 44 61 74 65 2e 6e
6f 77 28 29 20 2d 20 73  74 61 72 74 65 64 41 74
20 3c 20 74 69 6d 65 6f  75 74 4d 73 29 20 7b 0d
0a 20 20 20 20 69 66 20  28 21 6d 61 6e 61 67 65
64 53 65 72 76 69 63 65  50 72 6f 63 65 73 73 65
73 2e 68 61 73 28 73 65  72 76 69 63 65 49 64 29
29 20 7b 0d 0a 20 20 20  20 20 20 72 65 74 75 72
6e 20 66 61 6c 73 65 3b  0d 0a 20 20 20 20 7d 0d
0a 0d 0a 20 20 20 20 74  72 79 20 7b 0d 0a 20 20
20 20 20 20 63 6f 6e 73  74 20 72 65 73 70 6f 6e
73 65 20 3d 20 61 77 61  69 74 20 66 65 74 63 68
28 73 65 72 76 69 63 65  2e 68 65 61 6c 74 68 55
72 6c 29 3b 0d 0a 20 20  20 20 20 20 69 66 20 28
72 65 73 70 6f 6e 73 65  2e 6f 6b 29 20 7b 0d 0a
20 20 20 20 20 20 20 20  72 65 74 75 72 6e 20 74
72 75 65 3b 0d 0a 20 20  20 20 20 20 7d 0d 0a 20
20 20 20 7d 20 63 61 74  63 68 20 28 65 72 72 6f
72 29 20 7b 0d 0a 20 20  20 20 20 20 2f 2f 20 6b
65 65 70 20 70 6f 6c 6c  69 6e 67 20 75 6e 74 69
6c 20 74 69 6d 65 6f 75  74 0d 0a 20 20 20 20 7d
0d 0a 0d 0a 20 20 20 20  61 77 61 69 74 20 6e 65
77 20 50 72 6f 6d 69 73  65 28 28 72 65 73 6f 6c
76 65 29 20 3d 3e 20 73  65 74 54 69 6d 65 6f 75
74 28 72 65 73 6f 6c 76  65 2c 20 35 30 30 29 29
3b 0d 0a 20 20 7d 0d 0a  0d 0a 20 20 72 65 74 75
72 6e 20 66 61 6c 73 65  3b 0d 0a 7d 0d 0a 0d 0a
61 73 79 6e 63 20 66 75  6e 63 74 69 6f 6e 20 73
74 6f 70 4d 61 6e 61 67  65 64 53 65 72 76 69 63
65 28 73 65 72 76 69 63  65 49 64 29 20 7b 0d 0a
20 20 63 6f 6e 73 74 20  73 65 72 76 69 63 65 20
3d 20 67 65 74 4d 61 6e  61 67 65 64 53 65 72 76
69 63 65 43 6f 6e 66 69  67 28 73 65 72 76 69 63
65 49 64 29 3b 0d 0a 20  20 69 66 20 28 21 73 65
72 76 69 63 65 29 20 7b  0d 0a 20 20 20 20 74 68
72 6f 77 20 6e 65 77 20  45 72 72 6f 72 28 60 55
6e 6b 6e 6f 77 6e 20 73  65 72 76 69 63 65 20 69
64 3a 20 24 7b 73 65 72  76 69 63 65 49 64 7d 60
29 3b 0d 0a 20 20 7d 0d  0a 0d 0a 20 20 63 6f 6e
73 74 20 70 72 6f 63 65  73 73 48 61 6e 64 6c 65
20 3d 20 6d 61 6e 61 67  65 64 53 65 72 76 69 63
65 50 72 6f 63 65 73 73  65 73 2e 67 65 74 28 73
65 72 76 69 63 65 49 64  29 3b 0d 0a 20 20 69 66
20 28 21 70 72 6f 63 65  73 73 48 61 6e 64 6c 65
29 20 7b 0d 0a 20 20 20  20 63 6f 6e 73 74 20 63
6f 6e 66 69 67 75 72 65  64 20 3d 20 66 73 2e 65
78 69 73 74 73 53 79 6e  63 28 73 65 72 76 69 63
65 2e 76 65 6e 76 50 79  74 68 6f 6e 50 61 74 68
29 3b 0d 0a 20 20 20 20  73 65 74 4d 61 6e 61 67
65 64 53 65 72 76 69 63  65 52 75 6e 74 69 6d 65
28 73 65 72 76 69 63 65  49 64 2c 20 7b 0d 0a 20
20 20 20 20 20 73 74 61  74 75 73 3a 20 63 6f 6e
66 69 67 75 72 65 64 20  3f 20 27 73 74 6f 70 70
65 64 27 20 3a 20 27 6e  6f 74 5f 63 6f 6e 66 69
67 75 72 65 64 27 2c 0d  0a 20 20 20 20 20 20 70
69 64 3a 20 6e 75 6c 6c  2c 0d 0a 20 20 20 20 20
20 65 72 72 6f 72 3a 20  6e 75 6c 6c 2c 0d 0a 20
20 20 20 7d 29 3b 0d 0a  20 20 20 20 72 65 74 75
72 6e 20 62 75 69 6c 64  4d 61 6e 61 67 65 64 53
65 72 76 69 63 65 53 74  61 74 75 73 28 73 65 72
76 69 63 65 49 64 29 3b  0d 0a 20 20 7d 0d 0a 0d
0a 20 20 73 65 74 4d 61  6e 61 67 65 64 53 65 72
76 69 63 65 52 75 6e 74  69 6d 65 28 73 65 72 76
69 63 65 49 64 2c 20 7b  0d 0a 20 20 20 20 73 74
61 74 75 73 3a 20 27 73  74 6f 70 70 69 6e 67 27
2c 0d 0a 20 20 20 20 70  69 64 3a 20 70 72 6f 63
65 73 73 48 61 6e 64 6c  65 2e 70 69 64 20 7c 7c
20 6e 75 6c 6c 2c 0d 0a  20 20 20 20 65 72 72 6f
72 3a 20 6e 75 6c 6c 2c  0d 0a 20 20 7d 29 3b 0d
0a 0d 0a 20 20 74 72 79  20 7b 0d 0a 20 20 20 20
70 72 6f 63 65 73 73 48  61 6e 64 6c 65 2e 6b 69
6c 6c 28 29 3b 0d 0a 20  20 7d 20 63 61 74 63 68
20 28 65 72 72 6f 72 29  20 7b 0d 0a 20 20 20 20
63 6f 6e 73 6f 6c 65 2e  65 72 72 6f 72 28 60 5b
4d 61 6e 61 67 65 64 53  65 72 76 69 63 65 3a 24
7b 73 65 72 76 69 63 65  49 64 7d 5d 20 46 61 69
6c 65 64 20 74 6f 20 73  74 6f 70 20 70 72 6f 63
65 73 73 3a 60 2c 20 65  72 72 6f 72 29 3b 0d 0a
20 20 7d 0d 0a 0d 0a 20  20 63 6f 6e 73 74 20 65
78 69 74 65 64 20 3d 20  61 77 61 69 74 20 77 61
69 74 46 6f 72 50 72 6f  63 65 73 73 45 78 69 74
28 70 72 6f 63 65 73 73  48 61 6e 64 6c 65 2c 20
38 30 30 30 29 3b 0d 0a  20 20 69 66 20 28 21 65
78 69 74 65 64 29 20 7b  0d 0a 20 20 20 20 74 72
79 20 7b 0d 0a 20 20 20  20 20 20 70 72 6f 63 65
73 73 48 61 6e 64 6c 65  2e 6b 69 6c 6c 28 27 53
49 47 4b 49 4c 4c 27 29  3b 0d 0a 20 20 20 20 7d
20 63 61 74 63 68 20 28  65 72 72 6f 72 29 20 7b
0d 0a 20 20 20 20 20 20  63 6f 6e 73 6f 6c 65 2e
65 72 72 6f 72 28 60 5b  4d 61 6e 61 67 65 64 53
65 72 76 69 63 65 3a 24  7b 73 65 72 76 69 63 65
49 64 7d 5d 20 46 61 69  6c 65 64 20 74 6f 20 66
6f 72 63 65 20 6b 69 6c  6c 20 70 72 6f 63 65 73
73 3a 60 2c 20 65 72 72  6f 72 29 3b 0d 0a 20 20
20 20 7d 0d 0a 20 20 20  20 61 77 61 69 74 20 77
61 69 74 46 6f 72 50 72  6f 63 65 73 73 45 78 69
74 28 70 72 6f 63 65 73  73 48 61 6e 64 6c 65 2c
20 33 30 30 30 29 3b 0d  0a 20 20 7d 0d 0a 0d 0a
20 20 6d 61 6e 61 67 65  64 53 65 72 76 69 63 65
50 72 6f 63 65 73 73 65  73 2e 64 65 6c 65 74 65
28 73 65 72 76 69 63 65  49 64 29 3b 0d 0a 20 20
63 6f 6e 73 74 20 63 6f  6e 66 69 67 75 72 65 64
20 3d 20 66 73 2e 65 78  69 73 74 73 53 79 6e 63
28 73 65 72 76 69 63 65  2e 76 65 6e 76 50 79 74
68 6f 6e 50 61 74 68 29  3b 0d 0a 20 20 73 65 74
4d 61 6e 61 67 65 64 53  65 72 76 69 63 65 52 75
6e 74 69 6d 65 28 73 65  72 76 69 63 65 49 64 2c
20 7b 0d 0a 20 20 20 20  73 74 61 74 75 73 3a 20
63 6f 6e 66 69 67 75 72  65 64 20 3f 20 27 73 74
6f 70 70 65 64 27 20 3a  20 27 6e 6f 74 5f 63 6f
6e 66 69 67 75 72 65 64  27 2c 0d 0a 20 20 20 20
70 69 64 3a 20 6e 75 6c  6c 2c 0d 0a 20 20 20 20
65 72 72 6f 72 3a 20 6e  75 6c 6c 2c 0d 0a 20 20
7d 29 3b 0d 0a 20 20 72  65 74 75 72 6e 20 62 75
69 6c 64 4d 61 6e 61 67  65 64 53 65 72 76 69 63
65 53 74 61 74 75 73 28  73 65 72 76 69 63 65 49
64 29 3b 0d 0a 7d 0d 0a  0d 0a 61 73 79 6e 63 20
66 75 6e 63 74 69 6f 6e  20 73 74 61 72 74 4d 61
6e 61 67 65 64 53 65 72  76 69 63 65 28 73 65 72
76 69 63 65 49 64 29 20  7b 0d 0a 20 20 63 6f 6e
73 74 20 73 65 72 76 69  63 65 20 3d 20 67 65 74
4d 61 6e 61 67 65 64 53  65 72 76 69 63 65 43 6f
6e 66 69 67 28 73 65 72  76 69 63 65 49 64 29 3b
0d 0a 20 20 69 66 20 28  21 73 65 72 76 69 63 65
29 20 7b 0d 0a 20 20 20  20 74 68 72 6f 77 20 6e
65 77 20 45 72 72 6f 72  28 60 55 6e 6b 6e 6f 77
6e 20 73 65 72 76 69 63  65 20 69 64 3a 20 24 7b
73 65 72 76 69 63 65 49  64 7d 60 29 3b 0d 0a 20
20 7d 0d 0a 0d 0a 20 20  63 6f 6e 73 74 20 63 75
72 72 65 6e 74 20 3d 20  65 6e 73 75 72 65 4d 61
6e 61 67 65 64 53 65 72  76 69 63 65 52 75 6e 74
69 6d 65 28 73 65 72 76  69 63 65 49 64 29 3b 0d
0a 20 20 69 66 20 28 21  63 75 72 72 65 6e 74 29
20 7b 0d 0a 20 20 20 20  74 68 72 6f 77 20 6e 65
77 20 45 72 72 6f 72 28  60 55 6e 61 62 6c 65 20
74 6f 20 69 6e 69 74 69  61 6c 69 7a 65 20 73 65
72 76 69 63 65 20 73 74  61 74 75 73 20 66 6f 72
3a 20 24 7b 73 65 72 76  69 63 65 49 64 7d 60 29
3b 0d 0a 20 20 7d 0d 0a  0d 0a 20 20 69 66 20 28
63 75 72 72 65 6e 74 2e  73 74 61 74 75 73 20 3d
3d 3d 20 27 72 75 6e 6e  69 6e 67 27 20 7c 7c 20
63 75 72 72 65 6e 74 2e  73 74 61 74 75 73 20 3d
3d 3d 20 27 73 74 61 72  74 69 6e 67 27 29 20 7b
0d 0a 20 20 20 20 72 65  74 75 72 6e 20 62 75 69
6c 64 4d 61 6e 61 67 65  64 53 65 72 76 69 63 65
53 74 61 74 75 73 28 73  65 72 76 69 63 65 49 64
29 3b 0d 0a 20 20 7d 0d  0a 0d 0a 20 20 69 66 20
28 21 66 73 2e 65 78 69  73 74 73 53 79 6e 63 28
73 65 72 76 69 63 65 2e  73 65 72 76 69 63 65 52
6f 6f 74 29 29 20 7b 0d  0a 20 20 20 20 73 65 74
4d 61 6e 61 67 65 64 53  65 72 76 69 63 65 52 75
6e 74 69 6d 65 28 73 65  72 76 69 63 65 49 64 2c
20 7b 0d 0a 20 20 20 20  20 20 73 74 61 74 75 73
3a 20 27 65 72 72 6f 72  27 2c 0d 0a 20 20 20 20
20 20 70 69 64 3a 20 6e  75 6c 6c 2c 0d 0a 20 20
20 20 20 20 65 72 72 6f  72 3a 20 60 53 65 72 76
69 63 65 20 66 6f 6c 64  65 72 20 6e 6f 74 20 66
6f 75 6e 64 3a 20 24 7b  73 65 72 76 69 63 65 2e
73 65 72 76 69 63 65 52  6f 6f 74 7d 60 2c 0d 0a
20 20 20 20 7d 29 3b 0d  0a 20 20 20 20 72 65 74
75 72 6e 20 62 75 69 6c  64 4d 61 6e 61 67 65 64
53 65 72 76 69 63 65 53  74 61 74 75 73 28 73 65
72 76 69 63 65 49 64 29  3b 0d 0a 20 20 7d 0d 0a
0d 0a 20 20 2f 2f 20 49  66 20 76 65 6e 76 20 64
6f 65 73 6e 27 74 20 65  78 69 73 74 2c 20 63 72
65 61 74 65 20 69 74 20  61 6e 64 20 69 6e 73 74
61 6c 6c 20 6d 69 6e 69  6d 75 6d 20 70 61 63 6b
61 67 65 73 20 74 6f 20  62 6f 6f 74 20 74 68 65
20 46 61 73 74 41 50 49  20 73 65 72 76 65 72 2e
0d 0a 20 20 2f 2f 20 54  68 69 73 20 61 6c 6c 6f
77 73 20 2f 61 70 69 2f  76 31 2f 65 6e 76 2f 69
6e 73 74 61 6c 6c 20 74  6f 20 62 65 20 72 65 61
63 68 65 64 20 66 72 6f  6d 20 74 68 65 20 55 49
20 74 6f 20 69 6e 73 74  61 6c 6c 20 74 68 65 20
66 75 6c 6c 20 70 61 63  6b 61 67 65 20 73 65 74
2e 0d 0a 20 20 69 66 20  28 21 66 73 2e 65 78 69
73 74 73 53 79 6e 63 28  73 65 72 76 69 63 65 2e
76 65 6e 76 50 79 74 68  6f 6e 50 61 74 68 29 29
20 7b 0a 20 20 20 20 73  65 74 4d 61 6e 61 67 65
64 53 65 72 76 69 63 65  52 75 6e 74 69 6d 65 28
73 65 72 76 69 63 65 49  64 2c 20 7b 0d 0a 20 20
20 20 20 20 73 74 61 74  75 73 3a 20 27 73 74 61
72 74 69 6e 67 27 2c 0d  0a 20 20 20 20 20 20 70
69 64 3a 20 6e 75 6c 6c  2c 0d 0a 20 20 20 20 20
20 65 72 72 6f 72 3a 20  6e 75 6c 6c 2c 0d 0a 20
20 20 20 7d 29 3b 0d 0a  0d 0a 20 20 20 20 63 6f
6e 73 74 20 73 79 73 74  65 6d 50 79 74 68 6f 6e
20 3d 20 70 72 6f 63 65  73 73 2e 70 6c 61 74 66
6f 72 6d 20 3d 3d 3d 20  27 77 69 6e 33 32 27 20
3f 20 27 70 79 74 68 6f  6e 27 20 3a 20 27 70 79
74 68 6f 6e 33 27 3b 0d  0a 20 20 20 20 63 6f 6e
73 74 20 76 65 6e 76 44  69 72 20 3d 20 70 61 74
68 2e 6a 6f 69 6e 28 73  65 72 76 69 63 65 2e 73
65 72 76 69 63 65 52 6f  6f 74 2c 20 27 76 65 6e
76 27 29 3b 0d 0a 20 20  20 20 63 6f 6e 73 6f 6c
65 2e 6c 6f 67 28 60 5b  4d 61 6e 61 67 65 64 53
65 72 76 69 63 65 3a 24  7b 73 65 72 76 69 63 65
49 64 7d 5d 20 43 72 65  61 74 69 6e 67 20 76 65
6e 76 20 61 74 20 24 7b  76 65 6e 76 44 69 72 7d
2e 2e 2e 60 29 3b 0d 0a  0d 0a 20 20 20 20 74 72
79 20 7b 0d 0a 20 20 20  20 20 20 61 77 61 69 74
20 72 75 6e 43 6f 6d 6d  61 6e 64 28 73 79 73 74
65 6d 50 79 74 68 6f 6e  2c 20 5b 27 2d 6d 27 2c
20 27 76 65 6e 76 27 2c  20 76 65 6e 76 44 69 72
5d 2c 20 7b 20 73 68 65  6c 6c 3a 20 74 72 75 65
20 7d 29 3b 0d 0a 20 20  20 20 20 20 63 6f 6e 73
6f 6c 65 2e 6c 6f 67 28  60 5b 4d 61 6e 61 67 65
64 53 65 72 76 69 63 65  3a 24 7b 73 65 72 76 69
63 65 49 64 7d 5d 20 49  6e 73 74 61 6c 6c 69 6e
67 20 62 6f 6f 74 73 74  72 61 70 20 70 61 63 6b
61 67 65 73 2e 2e 2e 60  29 3b 0d 0a 20 20 20 20
20 20 63 6f 6e 73 74 20  62 6f 6f 74 73 74 72 61
70 50 6b 67 73 20 3d 0d  0a 20 20 20 20 20 20 20
20 73 65 72 76 69 63 65  2e 62 6f 6f 74 73 74 72
61 70 50 61 63 6b 61 67  65 73 20 7c 7c 0d 0a 20
20 20 20 20 20 20 20 42  4f 4f 54 53 54 52 41 50
5f 50 41 43 4b 41 47 45  53 5b 73 65 72 76 69 63
65 49 64 5d 20 7c 7c 0d  0a 20 20 20 20 20 20 20
20 5b 27 66 61 73 74 61  70 69 27 2c 20 27 75 76
69 63 6f 72 6e 27 2c 20  27 70 79 74 68 6f 6e 2d
6d 75 6c 74 69 70 61 72  74 27 5d 3b 0d 0a 20 20
20 20 20 20 61 77 61 69  74 20 72 75 6e 43 6f 6d
6d 61 6e 64 28 73 65 72  76 69 63 65 2e 76 65 6e
76 50 79 74 68 6f 6e 50  61 74 68 2c 20 5b 27 2d
6d 27 2c 20 27 70 69 70  27 2c 20 27 69 6e 73 74
61 6c 6c 27 2c 20 27 2d  2d 71 75 69 65 74 27 2c
20 2e 2e 2e 62 6f 6f 74  73 74 72 61 70 50 6b 67
73 5d 2c 20 7b 20 73 68  65 6c 6c 3a 20 74 72 75
65 20 7d 29 3b 0d 0a 20  20 20 20 20 20 63 6f 6e
73 6f 6c 65 2e 6c 6f 67  28 60 5b 4d 61 6e 61 67
65 64 53 65 72 76 69 63  65 3a 24 7b 73 65 72 76
69 63 65 49 64 7d 5d 20  42 6f 6f 74 73 74 72 61
70 20 63 6f 6d 70 6c 65  74 65 2e 60 29 3b 0d 0a
20 20 20 20 7d 20 63 61  74 63 68 20 28 65 72 72
6f 72 29 20 7b 0d 0a 20  20 20 20 20 20 73 65 74
4d 61 6e 61 67 65 64 53  65 72 76 69 63 65 52 75
6e 74 69 6d 65 28 73 65  72 76 69 63 65 49 64 2c
20 7b 0d 0a 20 20 20 20  20 20 20 20 73 74 61 74
75 73 3a 20 27 65 72 72  6f 72 27 2c 0d 0a 20 20
20 20 20 20 20 20 70 69  64 3a 20 6e 75 6c 6c 2c
0d 0a 20 20 20 20 20 20  20 20 65 72 72 6f 72 3a
20 60 46 61 69 6c 65 64  20 74 6f 20 63 72 65 61
74 65 20 76 65 6e 76 3a  20 24 7b 65 72 72 6f 72
2e 6d 65 73 73 61 67 65  7d 60 2c 0d 0a 20 20 20
20 20 20 7d 29 3b 0d 0a  20 20 20 20 20 20 72 65
74 75 72 6e 20 62 75 69  6c 64 4d 61 6e 61 67 65
64 53 65 72 76 69 63 65  53 74 61 74 75 73 28 73
65 72 76 69 63 65 49 64  29 3b 0d 0a 20 20 20 20
7d 0d 0a 20 20 7d 0a 0a  20 20 2f 2f 20 45 6e 73
75 72 65 20 65 64 67 65  2d 74 74 73 20 65 78 69
73 74 73 20 69 6e 20 65  78 69 73 74 69 6e 67 20
41 70 70 20 41 50 49 20  76 65 6e 76 73 20 73 6f
20 53 75 70 65 72 20 46  61 73 74 20 54 54 53 20
6f 6e 6c 79 20 6e 65 65  64 73 20 22 53 74 61 72
74 20 53 65 72 76 65 72  22 2e 0a 20 20 69 66 20
28 73 65 72 76 69 63 65  49 64 20 3d 3d 3d 20 27
61 70 70 27 29 20 7b 0a  20 20 20 20 74 72 79 20
7b 0a 20 20 20 20 20 20  61 77 61 69 74 20 72 75
6e 43 6f 6d 6d 61 6e 64  28 73 65 72 76 69 63 65
2e 76 65 6e 76 50 79 74  68 6f 6e 50 61 74 68 2c
20 5b 27 2d 63 27 2c 20  27 69 6d 70 6f 72 74 20
65 64 67 65 5f 74 74 73  27 5d 29 3b 0a 20 20 20
20 7d 20 63 61 74 63 68  20 28 5f 29 20 7b 0a 20
20 20 20 20 20 63 6f 6e  73 6f 6c 65 2e 6c 6f 67
28 27 5b 4d 61 6e 61 67  65 64 53 65 72 76 69 63
65 3a 61 70 70 5d 20 65  64 67 65 2d 74 74 73 20
6d 69 73 73 69 6e 67 2c  20 69 6e 73 74 61 6c 6c
69 6e 67 2e 2e 2e 27 29  3b 0a 20 20 20 20 20 20
74 72 79 20 7b 0a 20 20  20 20 20 20 20 20 61 77
61 69 74 20 72 75 6e 43  6f 6d 6d 61 6e 64 28 73
65 72 76 69 63 65 2e 76  65 6e 76 50 79 74 68 6f
6e 50 61 74 68 2c 20 5b  27 2d 6d 27 2c 20 27 70
69 70 27 2c 20 27 69 6e  73 74 61 6c 6c 27 2c 20
27 2d 2d 71 75 69 65 74  27 2c 20 27 65 64 67 65
2d 74 74 73 27 5d 2c 20  7b 20 73 68 65 6c 6c 3a
20 74 72 75 65 20 7d 29  3b 0a 20 20 20 20 20 20
7d 20 63 61 74 63 68 20  28 65 72 72 6f 72 29 20
7b 0a 20 20 20 20 20 20  20 20 73 65 74 4d 61 6e
61 67 65 64 53 65 72 76  69 63 65 52 75 6e 74 69
6d 65 28 73 65 72 76 69  63 65 49 64 2c 20 7b 0a
20 20 20 20 20 20 20 20  20 20 73 74 61 74 75 73
3a 20 27 65 72 72 6f 72  27 2c 0a 20 20 20 20 20
20 20 20 20 20 70 69 64  3a 20 6e 75 6c 6c 2c 0a
20 20 20 20 20 20 20 20  20 20 65 72 72 6f 72 3a
20 60 46 61 69 6c 65 64  20 74 6f 20 69 6e 73 74
61 6c 6c 20 65 64 67 65  2d 74 74 73 3a 20 24 7b
65 72 72 6f 72 2e 6d 65  73 73 61 67 65 7d 60 2c
0a 20 20 20 20 20 20 20  20 7d 29 3b 0a 20 20 20
20 20 20 20 20 72 65 74  75 72 6e 20 62 75 69 6c
64 4d 61 6e 61 67 65 64  53 65 72 76 69 63 65 53
74 61 74 75 73 28 73 65  72 76 69 63 65 49 64 29
3b 0a 20 20 20 20 20 20  7d 0a 20 20 20 20 7d 0a
20 20 7d 0a 0a 20 20 73  65 74 4d 61 6e 61 67 65
64 53 65 72 76 69 63 65  52 75 6e 74 69 6d 65 28
73 65 72 76 69 63 65 49  64 2c 20 7b 0a 20 20 20
20 73 74 61 74 75 73 3a  20 27 73 74 61 72 74 69
6e 67 27 2c 0a 20 20 20  20 70 69 64 3a 20 6e 75
6c 6c 2c 0d 0a 20 20 20  20 65 72 72 6f 72 3a 20
6e 75 6c 6c 2c 0d 0a 20  20 7d 29 3b 0d 0a 0d 0a
20 20 63 6f 6e 73 74 20  70 72 6f 63 65 73 73 48
61 6e 64 6c 65 20 3d 20  73 70 61 77 6e 28 0d 0a
20 20 20 20 73 65 72 76  69 63 65 2e 76 65 6e 76
50 79 74 68 6f 6e 50 61  74 68 2c 0d 0a 20 20 20
20 5b 27 2d 6d 27 2c 20  73 65 72 76 69 63 65 2e
65 6e 74 72 79 4d 6f 64  75 6c 65 5d 2c 0d 0a 20
20 20 20 7b 0d 0a 20 20  20 20 20 20 63 77 64 3a
20 73 65 72 76 69 63 65  2e 73 65 72 76 69 63 65
52 6f 6f 74 2c 0d 0a 20  20 20 20 20 20 65 6e 76
3a 20 7b 0d 0a 20 20 20  20 20 20 20 20 2e 2e 2e
70 72 6f 63 65 73 73 2e  65 6e 76 2c 0d 0a 20 20
20 20 20 20 20 20 50 59  54 48 4f 4e 55 4e 42 55
46 46 45 52 45 44 3a 20  27 31 27 2c 0d 0a 20 20
20 20 20 20 20 20 50 59  54 48 4f 4e 49 4f 45 4e
43 4f 44 49 4e 47 3a 20  27 75 74 66 2d 38 27 2c
0d 0a 20 20 20 20 20 20  7d 2c 0d 0a 20 20 20 20
20 20 73 74 64 69 6f 3a  20 5b 27 69 67 6e 6f 72
65 27 2c 20 27 70 69 70  65 27 2c 20 27 70 69 70
65 27 5d 2c 0d 0a 20 20  20 20 7d 0d 0a 20 20 29
3b 0d 0a 0d 0a 20 20 6d  61 6e 61 67 65 64 53 65
72 76 69 63 65 50 72 6f  63 65 73 73 65 73 2e 73
65 74 28 73 65 72 76 69  63 65 49 64 2c 20 70 72
6f 63 65 73 73 48 61 6e  64 6c 65 29 3b 0d 0a 20
20 73 65 74 4d 61 6e 61  67 65 64 53 65 72 76 69
63 65 52 75 6e 74 69 6d  65 28 73 65 72 76 69 63
65 49 64 2c 20 7b 0d 0a  20 20 20 20 73 74 61 74
75 73 3a 20 27 73 74 61  72 74 69 6e 67 27 2c 0d
0a 20 20 20 20 70 69 64  3a 20 70 72 6f 63 65 73
73 48 61 6e 64 6c 65 2e  70 69 64 20 7c 7c 20 6e
75 6c 6c 2c 0d 0a 20 20  20 20 65 72 72 6f 72 3a
20 6e 75 6c 6c 2c 0d 0a  20 20 7d 29 3b 0d 0a 0d
0a 20 20 70 72 6f 63 65  73 73 48 61 6e 64 6c 65
2e 73 74 64 6f 75 74 2e  6f 6e 28 27 64 61 74 61
27 2c 20 28 64 61 74 61  29 20 3d 3e 20 7b 0d 0a
20 20 20 20 63 6f 6e 73  74 20 74 65 78 74 20 3d
20 64 61 74 61 2e 74 6f  53 74 72 69 6e 67 28 29
2e 74 72 69 6d 28 29 3b  0d 0a 20 20 20 20 63 6f
6e 73 6f 6c 65 2e 6c 6f  67 28 60 5b 4d 61 6e 61
67 65 64 53 65 72 76 69  63 65 3a 24 7b 73 65 72
76 69 63 65 49 64 7d 5d  60 2c 20 74 65 78 74 29
3b 0d 0a 20 20 20 20 2f  2f 20 27 61 70 70 27 20
73 65 72 76 69 63 65 20  6c 6f 67 73 20 74 6f 20
61 70 70 2d 73 65 72 76  69 63 65 2e 6c 6f 67 20
76 69 61 20 69 74 73 20  6f 77 6e 20 50 79 74 68
6f 6e 20 46 69 6c 65 48  61 6e 64 6c 65 72 3b 20
73 6b 69 70 20 74 6f 20  61 76 6f 69 64 20 64 75
70 6c 69 63 61 74 69 6f  6e 0d 0a 20 20 20 20 69
66 20 28 73 65 72 76 69  63 65 49 64 20 21 3d 3d
20 27 61 70 70 27 29 20  61 70 70 65 6e 64 54 6f
53 65 72 76 69 63 65 4c  6f 67 28 73 65 72 76 69
63 65 49 64 2c 20 74 65  78 74 29 3b 0d 0a 20 20
7d 29 3b 0d 0a 0d 0a 20  20 70 72 6f 63 65 73 73
48 61 6e 64 6c 65 2e 73  74 64 65 72 72 2e 6f 6e
28 27 64 61 74 61 27 2c  20 28 64 61 74 61 29 20
3d 3e 20 7b 0d 0a 20 20  20 20 63 6f 6e 73 74 20
74 65 78 74 20 3d 20 64  61 74 61 2e 74 6f 53 74
72 69 6e 67 28 29 2e 74  72 69 6d 28 29 3b 0d 0a
20 20 20 20 63 6f 6e 73  6f 6c 65 2e 65 72 72 6f
72 28 60 5b 4d 61 6e 61  67 65 64 53 65 72 76 69
63 65 3a 24 7b 73 65 72  76 69 63 65 49 64 7d 3a
65 72 72 6f 72 5d 60 2c  20 74 65 78 74 29 3b 0d
0a 20 20 20 20 69 66 20  28 73 65 72 76 69 63 65
49 64 20 21 3d 3d 20 27  61 70 70 27 29 20 61 70
70 65 6e 64 54 6f 53 65  72 76 69 63 65 4c 6f 67
28 73 65 72 76 69 63 65  49 64 2c 20 74 65 78 74
29 3b 0d 0a 20 20 7d 29  3b 0d 0a 0d 0a 20 20 70
72 6f 63 65 73 73 48 61  6e 64 6c 65 2e 6f 6e 28
27 65 72 72 6f 72 27 2c  20 28 65 72 72 6f 72 29
20 3d 3e 20 7b 0d 0a 20  20 20 20 6d 61 6e 61 67
65 64 53 65 72 76 69 63  65 50 72 6f 63 65 73 73
65 73 2e 64 65 6c 65 74  65 28 73 65 72 76 69 63
65 49 64 29 3b 0d 0a 20  20 20 20 73 65 74 4d 61
6e 61 67 65 64 53 65 72  76 69 63 65 52 75 6e 74
69 6d 65 28 73 65 72 76  69 63 65 49 64 2c 20 7b
0d 0a 20 20 20 20 20 20  73 74 61 74 75 73 3a 20
27 65 72 72 6f 72 27 2c  0d 0a 20 20 20 20 20 20
70 69 64 3a 20 6e 75 6c  6c 2c 0d 0a 20 20 20 20
20 20 65 72 72 6f 72 3a  20 65 72 72 6f 72 2e 6d
65 73 73 61 67 65 2c 0d  0a 20 20 20 20 7d 29 3b
0d 0a 20 20 7d 29 3b 0d  0a 0d 0a 20 20 70 72 6f
63 65 73 73 48 61 6e 64  6c 65 2e 6f 6e 28 27 65
78 69 74 27 2c 20 28 63  6f 64 65 2c 20 73 69 67
6e 61 6c 29 20 3d 3e 20  7b 0d 0a 20 20 20 20 6d
61 6e 61 67 65 64 53 65  72 76 69 63 65 50 72 6f
63 65 73 73 65 73 2e 64  65 6c 65 74 65 28 73 65
72 76 69 63 65 49 64 29  3b 0d 0a 20 20 20 20 63
6f 6e 73 74 20 72 75 6e  74 69 6d 65 20 3d 20 65
6e 73 75 72 65 4d 61 6e  61 67 65 64 53 65 72 76
69 63 65 52 75 6e 74 69  6d 65 28 73 65 72 76 69
63 65 49 64 29 3b 0d 0a  20 20 20 20 63 6f 6e 73
74 20 63 6f 6e 66 69 67  75 72 65 64 20 3d 20 66
73 2e 65 78 69 73 74 73  53 79 6e 63 28 73 65 72
76 69 63 65 2e 76 65 6e  76 50 79 74 68 6f 6e 50
61 74 68 29 3b 0d 0a 20  20 20 20 63 6f 6e 73 74
20 73 74 6f 70 70 65 64  42 79 52 65 71 75 65 73
74 20 3d 20 72 75 6e 74  69 6d 65 20 26 26 20 72
75 6e 74 69 6d 65 2e 73  74 61 74 75 73 20 3d 3d
3d 20 27 73 74 6f 70 70  69 6e 67 27 3b 0d 0a 20
20 20 20 63 6f 6e 73 74  20 65 78 69 74 45 72 72
6f 72 20 3d 20 73 74 6f  70 70 65 64 42 79 52 65
71 75 65 73 74 20 7c 7c  20 63 6f 64 65 20 3d 3d
3d 20 30 0d 0a 20 20 20  20 20 20 3f 20 6e 75 6c
6c 0d 0a 20 20 20 20 20  20 3a 20 60 45 78 69 74
65 64 20 77 69 74 68 20  63 6f 64 65 20 24 7b 63
6f 64 65 7d 24 7b 73 69  67 6e 61 6c 20 3f 20 60
2c 20 73 69 67 6e 61 6c  20 24 7b 73 69 67 6e 61
6c 7d 60 20 3a 20 27 27  7d 60 3b 0d 0a 0d 0a 20
20 20 20 73 65 74 4d 61  6e 61 67 65 64 53 65 72
76 69 63 65 52 75 6e 74  69 6d 65 28 73 65 72 76
69 63 65 49 64 2c 20 7b  0d 0a 20 20 20 20 20 20
73 74 61 74 75 73 3a 20  63 6f 6e 66 69 67 75 72
65 64 20 3f 20 28 73 74  6f 70 70 65 64 42 79 52
65 71 75 65 73 74 20 3f  20 27 73 74 6f 70 70 65
64 27 20 3a 20 65 78 69  74 45 72 72 6f 72 20 3f
20 27 65 72 72 6f 72 27  20 3a 20 27 73 74 6f 70
70 65 64 27 29 20 3a 20  27 6e 6f 74 5f 63 6f 6e
66 69 67 75 72 65 64 27  2c 0d 0a 20 20 20 20 20
20 70 69 64 3a 20 6e 75  6c 6c 2c 0d 0a 20 20 20
20 20 20 65 72 72 6f 72  3a 20 65 78 69 74 45 72
72 6f 72 2c 0d 0a 20 20  20 20 7d 29 3b 0d 0a 20
20 7d 29 3b 0d 0a 0d 0a  20 20 63 6f 6e 73 74 20
72 65 61 64 79 20 3d 20  61 77 61 69 74 20 77 61
69 74 46 6f 72 4d 61 6e  61 67 65 64 53 65 72 76
69 63 65 52 65 61 64 79  28 73 65 72 76 69 63 65
49 64 2c 20 73 65 72 76  69 63 65 2e 73 74 61 72
74 75 70 54 69 6d 65 6f  75 74 4d 73 29 3b 0d 0a
20 20 69 66 20 28 21 72  65 61 64 79 29 20 7b 0d
0a 20 20 20 20 61 77 61  69 74 20 73 74 6f 70 4d
61 6e 61 67 65 64 53 65  72 76 69 63 65 28 73 65
72 76 69 63 65 49 64 29  3b 0d 0a 20 20 20 20 73
65 74 4d 61 6e 61 67 65  64 53 65 72 76 69 63 65
52 75 6e 74 69 6d 65 28  73 65 72 76 69 63 65 49
64 2c 20 7b 0d 0a 20 20  20 20 20 20 73 74 61 74
75 73 3a 20 27 65 72 72  6f 72 27 2c 0d 0a 20 20
20 20 20 20 70 69 64 3a  20 6e 75 6c 6c 2c 0d 0a
20 20 20 20 20 20 65 72  72 6f 72 3a 20 60 53 65
72 76 69 63 65 20 64 69  64 20 6e 6f 74 20 62 65
63 6f 6d 65 20 68 65 61  6c 74 68 79 20 69 6e 20
74 69 6d 65 20 28 24 7b  73 65 72 76 69 63 65 2e
68 65 61 6c 74 68 55 72  6c 7d 29 60 2c 0d 0a 20
20 20 20 7d 29 3b 0d 0a  20 20 20 20 72 65 74 75
72 6e 20 62 75 69 6c 64  4d 61 6e 61 67 65 64 53
65 72 76 69 63 65 53 74  61 74 75 73 28 73 65 72
76 69 63 65 49 64 29 3b  0d 0a 20 20 7d 0d 0a 0d
0a 20 20 73 65 74 4d 61  6e 61 67 65 64 53 65 72
76 69 63 65 52 75 6e 74  69 6d 65 28 73 65 72 76
69 63 65 49 64 2c 20 7b  0d 0a 20 20 20 20 73 74
61 74 75 73 3a 20 27 72  75 6e 6e 69 6e 67 27 2c
0d 0a 20 20 20 20 70 69  64 3a 20 70 72 6f 63 65
73 73 48 61 6e 64 6c 65  2e 70 69 64 20 7c 7c 20
6e 75 6c 6c 2c 0d 0a 20  20 20 20 65 72 72 6f 72
3a 20 6e 75 6c 6c 2c 0d  0a 20 20 7d 29 3b 0d 0a
20 20 72 65 74 75 72 6e  20 62 75 69 6c 64 4d 61
6e 61 67 65 64 53 65 72  76 69 63 65 53 74 61 74
75 73 28 73 65 72 76 69  63 65 49 64 29 3b 0d 0a
7d 0d 0a 0d 0a 61 73 79  6e 63 20 66 75 6e 63 74
69 6f 6e 20 72 65 73 74  61 72 74 4d 61 6e 61 67
65 64 53 65 72 76 69 63  65 28 73 65 72 76 69 63
65 49 64 29 20 7b 0d 0a  20 20 61 77 61 69 74 20
73 74 6f 70 4d 61 6e 61  67 65 64 53 65 72 76 69
63 65 28 73 65 72 76 69  63 65 49 64 29 3b 0d 0a
20 20 72 65 74 75 72 6e  20 73 74 61 72 74 4d 61
6e 61 67 65 64 53 65 72  76 69 63 65 28 73 65 72
76 69 63 65 49 64 29 3b  0d 0a 7d 0d 0a 0d 0a 66
75 6e 63 74 69 6f 6e 20  69 6e 69 74 69 61 6c 69
7a 65 4d 61 6e 61 67 65  64 53 65 72 76 69 63 65
73 53 74 61 74 65 28 29  20 7b 0d 0a 20 20 4d 41
4e 41 47 45 44 5f 53 45  52 56 49 43 45 53 2e 66
6f 72 45 61 63 68 28 28  73 65 72 76 69 63 65 29
20 3d 3e 20 7b 0d 0a 20  20 20 20 6d 61 6e 61 67
65 64 53 65 72 76 69 63  65 52 75 6e 74 69 6d 65
2e 73 65 74 28 73 65 72  76 69 63 65 2e 69 64 2c
20 67 65 74 49 6e 69 74  69 61 6c 4d 61 6e 61 67
65 64 53 65 72 76 69 63  65 52 75 6e 74 69 6d 65
28 73 65 72 76 69 63 65  2e 69 64 29 29 3b 0d 0a
20 20 7d 29 3b 0d 0a 7d  0d 0a 66 75 6e 63 74 69
6f 6e 20 67 65 74 56 65  6e 76 44 69 72 28 29 20
7b 0d 0a 20 20 72 65 74  75 72 6e 20 70 72 6f 63
65 73 73 2e 65 6e 76 2e  56 4f 49 43 45 5f 43 4c
4f 4e 45 5f 56 45 4e 56  5f 44 49 52 20 7c 7c 20
70 61 74 68 2e 6a 6f 69  6e 28 67 65 74 49 6e 73
74 61 6c 6c 44 69 72 28  29 2c 20 27 2e 76 65 6e
76 27 29 3b 0d 0a 7d 0d  0a 0d 0a 66 75 6e 63 74
69 6f 6e 20 67 65 74 55  76 50 61 74 68 28 29 20
7b 0d 0a 20 20 69 66 20  28 70 72 6f 63 65 73 73
2e 65 6e 76 2e 56 4f 49  43 45 5f 43 4c 4f 4e 45
5f 55 56 5f 50 41 54 48  29 20 7b 0d 0a 20 20 20
20 72 65 74 75 72 6e 20  70 72 6f 63 65 73 73 2e
65 6e 76 2e 56 4f 49 43  45 5f 43 4c 4f 4e 45 5f
55 56 5f 50 41 54 48 3b  0d 0a 20 20 7d 0d 0a 20
20 69 66 20 28 61 70 70  2e 69 73 50 61 63 6b 61
67 65 64 29 20 7b 0d 0a  20 20 20 20 72 65 74 75
72 6e 20 70 61 74 68 2e  6a 6f 69 6e 28 70 72 6f
63 65 73 73 2e 72 65 73  6f 75 72 63 65 73 50 61
74 68 2c 20 27 75 76 27  2c 20 27 75 76 2e 65 78
65 27 29 3b 0d 0a 20 20  7d 0d 0a 20 20 72 65 74
75 72 6e 20 27 75 76 27  3b 0d 0a 7d 0d 0a 0d 0a
66 75 6e 63 74 69 6f 6e  20 67 65 74 56 6f 69 63
65 43 6c 6f 6e 65 53 65  72 76 65 72 50 61 74 68
28 29 20 7b 0d 0a 20 20  69 66 20 28 61 70 70 2e
69 73 50 61 63 6b 61 67  65 64 29 20 7b 0d 0a 20
20 20 20 72 65 74 75 72  6e 20 70 61 74 68 2e 6a
6f 69 6e 28 61 70 70 2e  67 65 74 41 70 70 50 61
74 68 28 29 2c 20 27 65  6c 65 63 74 72 6f 6e 27
2c 20 27 76 6f 69 63 65  2d 63 6c 6f 6e 65 2d 73
65 72 76 65 72 2e 70 79  27 29 3b 0d 0a 20 20 7d
0d 0a 20 20 72 65 74 75  72 6e 20 70 61 74 68 2e
6a 6f 69 6e 28 70 72 6f  63 65 73 73 2e 63 77 64
28 29 2c 20 27 65 6c 65  63 74 72 6f 6e 27 2c 20
27 76 6f 69 63 65 2d 63  6c 6f 6e 65 2d 73 65 72
76 65 72 2e 70 79 27 29  3b 0d 0a 7d 0d 0a 0d 0a
66 75 6e 63 74 69 6f 6e  20 67 65 74 41 73 73 65
74 73 52 6f 6f 74 28 29  20 7b 0d 0a 20 20 69 66
20 28 70 72 6f 63 65 73  73 2e 65 6e 76 2e 56 4f
49 43 45 5f 43 4c 4f 4e  45 5f 41 53 53 45 54 53
29 20 7b 0d 0a 20 20 20  20 72 65 74 75 72 6e 20
70 72 6f 63 65 73 73 2e  65 6e 76 2e 56 4f 49 43
45 5f 43 4c 4f 4e 45 5f  41 53 53 45 54 53 3b 0d
0a 20 20 7d 0d 0a 20 20  69 66 20 28 61 70 70 2e
69 73 50 61 63 6b 61 67  65 64 29 20 7b 0d 0a 20
20 20 20 72 65 74 75 72  6e 20 70 61 74 68 2e 6a
6f 69 6e 28 61 70 70 2e  67 65 74 41 70 70 50 61
74 68 28 29 2c 20 27 46  35 2d 54 54 53 2d 56 69
65 74 6e 61 6d 65 73 65  27 29 3b 0d 0a 20 20 7d
0d 0a 20 20 72 65 74 75  72 6e 20 70 61 74 68 2e
6a 6f 69 6e 28 70 72 6f  63 65 73 73 2e 63 77 64
28 29 2c 20 27 46 35 2d  54 54 53 2d 56 69 65 74
6e 61 6d 65 73 65 27 29  3b 0d 0a 7d 0d 0a 0d 0a
66 75 6e 63 74 69 6f 6e  20 67 65 74 56 6f 69 63
65 73 4a 73 6f 6e 50 61  74 68 28 29 20 7b 0d 0a
20 20 69 66 20 28 70 72  6f 63 65 73 73 2e 65 6e
76 2e 56 4f 49 43 45 5f  43 4c 4f 4e 45 5f 56 4f
49 43 45 53 5f 4a 53 4f  4e 29 20 7b 0d 0a 20 20
20 20 72 65 74 75 72 6e  20 70 72 6f 63 65 73 73
2e 65 6e 76 2e 56 4f 49  43 45 5f 43 4c 4f 4e 45
5f 56 4f 49 43 45 53 5f  4a 53 4f 4e 3b 0d 0a 20
20 7d 0d 0a 20 20 69 66  20 28 61 70 70 2e 69 73
50 61 63 6b 61 67 65 64  29 20 7b 0d 0a 20 20 20
20 72 65 74 75 72 6e 20  70 61 74 68 2e 6a 6f 69
6e 28 61 70 70 2e 67 65  74 41 70 70 50 61 74 68
28 29 2c 20 27 73 68 61  72 65 64 27 2c 20 27 76
6f 69 63 65 2d 63 6c 6f  6e 65 27 2c 20 27 76 6f
69 63 65 73 2e 6a 73 6f  6e 27 29 3b 0d 0a 20 20
7d 0d 0a 20 20 72 65 74  75 72 6e 20 70 61 74 68
2e 6a 6f 69 6e 28 70 72  6f 63 65 73 73 2e 63 77
64 28 29 2c 20 27 73 68  61 72 65 64 27 2c 20 27
76 6f 69 63 65 2d 63 6c  6f 6e 65 27 2c 20 27 76
6f 69 63 65 73 2e 6a 73  6f 6e 27 29 3b 0d 0a 7d
0d 0a 0d 0a 66 75 6e 63  74 69 6f 6e 20 67 65 74
54 74 73 46 61 73 74 53  65 72 76 65 72 50 61 74
68 28 29 20 7b 0d 0a 20  20 69 66 20 28 61 70 70
2e 69 73 50 61 63 6b 61  67 65 64 29 20 7b 0d 0a
20 20 20 20 72 65 74 75  72 6e 20 70 61 74 68 2e
6a 6f 69 6e 28 61 70 70  2e 67 65 74 41 70 70 50
61 74 68 28 29 2c 20 27  65 6c 65 63 74 72 6f 6e
27 2c 20 27 74 74 73 2d  66 61 73 74 2d 73 65 72
76 65 72 2e 70 79 27 29  3b 0d 0a 20 20 7d 0d 0a
20 20 72 65 74 75 72 6e  20 70 61 74 68 2e 6a 6f
69 6e 28 70 72 6f 63 65  73 73 2e 63 77 64 28 29
2c 20 27 65 6c 65 63 74  72 6f 6e 27 2c 20 27 74
74 73 2d 66 61 73 74 2d  73 65 72 76 65 72 2e 70
79 27 29 3b 0d 0a 7d 0d  0a 0d 0a 66 75 6e 63 74
69 6f 6e 20 67 65 74 56  69 65 4e 65 75 54 74 73
52 6f 6f 74 28 29 20 7b  0d 0a 20 20 69 66 20 28
70 72 6f 63 65 73 73 2e  65 6e 76 2e 56 49 45 4e
45 55 5f 54 54 53 5f 52  4f 4f 54 29 20 7b 0d 0a
20 20 20 20 72 65 74 75  72 6e 20 70 72 6f 63 65
73 73 2e 65 6e 76 2e 56  49 45 4e 45 55 5f 54 54
53 5f 52 4f 4f 54 3b 0d  0a 20 20 7d 0d 0a 20 20
69 66 20 28 61 70 70 2e  69 73 50 61 63 6b 61 67
65 64 29 20 7b 0d 0a 20  20 20 20 72 65 74 75 72
6e 20 70 61 74 68 2e 6a  6f 69 6e 28 61 70 70 2e
67 65 74 41 70 70 50 61  74 68 28 29 2c 20 27 56
69 65 4e 65 75 2d 54 54  53 2d 46 61 73 74 2d 56
69 65 74 6e 61 6d 65 73  65 27 29 3b 0d 0a 20 20
7d 0d 0a 20 20 72 65 74  75 72 6e 20 70 61 74 68
2e 6a 6f 69 6e 28 70 72  6f 63 65 73 73 2e 63 77
64 28 29 2c 20 27 56 69  65 4e 65 75 2d 54 54 53
2d 46 61 73 74 2d 56 69  65 74 6e 61 6d 65 73 65
27 29 3b 0d 0a 7d 0d 0a  0d 0a 66 75 6e 63 74 69
6f 6e 20 72 75 6e 43 6f  6d 6d 61 6e 64 28 63 6d
64 2c 20 61 72 67 73 2c  20 6f 70 74 73 20 3d 20
7b 7d 29 20 7b 0d 0a 20  20 72 65 74 75 72 6e 20
6e 65 77 20 50 72 6f 6d  69 73 65 28 28 72 65 73
6f 6c 76 65 2c 20 72 65  6a 65 63 74 29 20 3d 3e
20 7b 0d 0a 20 20 20 20  63 6f 6e 73 74 20 70 72
6f 63 20 3d 20 73 70 61  77 6e 28 63 6d 64 2c 20
61 72 67 73 2c 20 7b 20  73 74 64 69 6f 3a 20 27
69 6e 68 65 72 69 74 27  2c 20 2e 2e 2e 6f 70 74
73 20 7d 29 3b 0d 0a 20  20 20 20 70 72 6f 63 2e
6f 6e 28 27 65 72 72 6f  72 27 2c 20 72 65 6a 65
63 74 29 3b 0d 0a 20 20  20 20 70 72 6f 63 2e 6f
6e 28 27 63 6c 6f 73 65  27 2c 20 28 63 6f 64 65
29 20 3d 3e 20 7b 0d 0a  20 20 20 20 20 20 69 66
20 28 63 6f 64 65 20 3d  3d 3d 20 30 29 20 72 65
73 6f 6c 76 65 28 29 3b  0d 0a 20 20 20 20 20 20
65 6c 73 65 20 72 65 6a  65 63 74 28 6e 65 77 20
45 72 72 6f 72 28 60 24  7b 63 6d 64 7d 20 65 78
69 74 65 64 20 77 69 74  68 20 63 6f 64 65 20 24
7b 63 6f 64 65 7d 60 29  29 3b 0d 0a 20 20 20 20
7d 29 3b 0d 0a 20 20 7d  29 3b 0d 0a 7d 0d 0a 0d
0a 66 75 6e 63 74 69 6f  6e 20 72 75 6e 43 6f 6d
6d 61 6e 64 57 69 74 68  50 72 6f 67 72 65 73 73
28 63 6d 64 2c 20 61 72  67 73 2c 20 6f 70 74 73
20 3d 20 7b 7d 2c 20 6f  6e 44 61 74 61 29 20 7b
0d 0a 20 20 72 65 74 75  72 6e 20 6e 65 77 20 50
72 6f 6d 69 73 65 28 28  72 65 73 6f 6c 76 65 2c
20 72 65 6a 65 63 74 29  20 3d 3e 20 7b 0d 0a 20
20 20 20 63 6f 6e 73 74  20 70 72 6f 63 20 3d 20
73 70 61 77 6e 28 63 6d  64 2c 20 61 72 67 73 2c
20 7b 20 2e 2e 2e 6f 70  74 73 2c 20 73 74 64 69
6f 3a 20 5b 27 69 67 6e  6f 72 65 27 2c 20 27 70
69 70 65 27 2c 20 27 70  69 70 65 27 5d 20 7d 29
3b 0d 0a 20 20 20 20 70  72 6f 63 2e 73 74 64 6f
75 74 2e 6f 6e 28 27 64  61 74 61 27 2c 20 28 64
61 74 61 29 20 3d 3e 20  7b 0d 0a 20 20 20 20 20
20 63 6f 6e 73 74 20 6c  69 6e 65 20 3d 20 64 61
74 61 2e 74 6f 53 74 72  69 6e 67 28 29 2e 74 72
69 6d 28 29 3b 0d 0a 20  20 20 20 20 20 69 66 20
28 6c 69 6e 65 20 26 26  20 6f 6e 44 61 74 61 29
20 6f 6e 44 61 74 61 28  6c 69 6e 65 29 3b 0d 0a
20 20 20 20 7d 29 3b 0d  0a 20 20 20 20 70 72 6f
63 2e 73 74 64 65 72 72  2e 6f 6e 28 27 64 61 74
61 27 2c 20 28 64 61 74  61 29 20 3d 3e 20 7b 0d
0a 20 20 20 20 20 20 63  6f 6e 73 74 20 6c 69 6e
65 20 3d 20 64 61 74 61  2e 74 6f 53 74 72 69 6e
67 28 29 2e 74 72 69 6d  28 29 3b 0d 0a 20 20 20
20 20 20 69 66 20 28 6c  69 6e 65 20 26 26 20 6f
6e 44 61 74 61 29 20 6f  6e 44 61 74 61 28 6c 69
6e 65 29 3b 0d 0a 20 20  20 20 7d 29 3b 0d 0a 20
20 20 20 70 72 6f 63 2e  6f 6e 28 27 65 72 72 6f
72 27 2c 20 72 65 6a 65  63 74 29 3b 0d 0a 20 20
20 20 70 72 6f 63 2e 6f  6e 28 27 63 6c 6f 73 65
27 2c 20 28 63 6f 64 65  29 20 3d 3e 20 7b 0d 0a
20 20 20 20 20 20 69 66  20 28 63 6f 64 65 20 3d
3d 3d 20 30 29 20 72 65  73 6f 6c 76 65 28 29 3b
0d 0a 20 20 20 20 20 20  65 6c 73 65 20 72 65 6a
65 63 74 28 6e 65 77 20  45 72 72 6f 72 28 60 24
7b 63 6d 64 7d 20 65 78  69 74 65 64 20 77 69 74
68 20 63 6f 64 65 20 24  7b 63 6f 64 65 7d 60 29
29 3b 0d 0a 20 20 20 20  7d 29 3b 0d 0a 20 20 7d
29 3b 0d 0a 7d 0d 0a 0d  0a 61 73 79 6e 63 20 66
75 6e 63 74 69 6f 6e 20  65 6e 73 75 72 65 56 6f
69 63 65 43 6c 6f 6e 65  52 75 6e 74 69 6d 65 28
29 20 7b 0d 0a 20 20 63  6f 6e 73 74 20 76 65 6e
76 44 69 72 20 3d 20 67  65 74 56 65 6e 76 44 69
72 28 29 3b 0d 0a 20 20  63 6f 6e 73 74 20 6d 61
72 6b 65 72 20 3d 20 70  61 74 68 2e 6a 6f 69 6e
28 76 65 6e 76 44 69 72  2c 20 27 2e 72 65 61 64
79 2e 6a 73 6f 6e 27 29  3b 0d 0a 20 20 69 66 20
28 66 73 2e 65 78 69 73  74 73 53 79 6e 63 28 6d
61 72 6b 65 72 29 29 20  7b 0d 0a 20 20 20 20 63
6f 6e 73 6f 6c 65 2e 6c  6f 67 28 27 5b 56 6f 69
63 65 43 6c 6f 6e 65 5d  20 52 75 6e 74 69 6d 65
20 61 6c 72 65 61 64 79  20 72 65 61 64 79 3a 27
2c 20 6d 61 72 6b 65 72  29 3b 0d 0a 20 20 20 20
72 65 74 75 72 6e 3b 0d  0a 20 20 7d 0d 0a 0d 0a
20 20 63 6f 6e 73 74 20  75 76 50 61 74 68 20 3d
20 67 65 74 55 76 50 61  74 68 28 29 3b 0d 0a 20
20 63 6f 6e 73 6f 6c 65  2e 6c 6f 67 28 27 5b 56
6f 69 63 65 43 6c 6f 6e  65 5d 20 43 72 65 61 74
69 6e 67 20 76 65 6e 76  20 77 69 74 68 20 75 76
3a 27 2c 20 75 76 50 61  74 68 2c 20 76 65 6e 76
44 69 72 29 3b 0d 0a 20  20 61 77 61 69 74 20 72
75 6e 43 6f 6d 6d 61 6e  64 28 75 76 50 61 74 68
2c 20 5b 27 76 65 6e 76  27 2c 20 76 65 6e 76 44
69 72 5d 2c 20 7b 20 73  68 65 6c 6c 3a 20 74 72
75 65 20 7d 29 3b 0d 0a  0d 0a 20 20 63 6f 6e 73
74 20 70 79 74 68 6f 6e  50 61 74 68 20 3d 20 70
61 74 68 2e 6a 6f 69 6e  28 76 65 6e 76 44 69 72
2c 20 27 53 63 72 69 70  74 73 27 2c 20 27 70 79
74 68 6f 6e 2e 65 78 65  27 29 3b 0d 0a 20 20 63
6f 6e 73 74 20 65 78 74  72 61 49 6e 64 65 78 55
72 6c 20 3d 20 27 68 74  74 70 73 3a 2f 2f 64 6f
77 6e 6c 6f 61 64 2e 70  79 74 6f 72 63 68 2e 6f
72 67 2f 77 68 6c 2f 63  75 31 32 34 27 3b 0d 0a
20 20 63 6f 6e 73 74 20  66 35 54 74 73 4c 6f 63
61 6c 50 61 74 68 20 3d  20 67 65 74 41 73 73 65
74 73 52 6f 6f 74 28 29  3b 20 2f 2f 20 46 35 2d
54 54 53 2d 56 69 65 74  6e 61 6d 65 73 65 20 6c
6f 63 61 6c 20 70 61 63  6b 61 67 65 0d 0a 0d 0a
20 20 63 6f 6e 73 74 20  70 61 63 6b 61 67 65 73
20 3d 20 5b 0d 0a 20 20  20 20 27 74 6f 72 63 68
3d 3d 32 2e 34 2e 30 2b  63 75 31 32 34 27 2c 0d
0a 20 20 20 20 27 74 6f  72 63 68 61 75 64 69 6f
3d 3d 32 2e 34 2e 30 2b  63 75 31 32 34 27 2c 0d
0a 20 20 20 20 27 66 61  73 74 61 70 69 27 2c 0d
0a 20 20 20 20 27 75 76  69 63 6f 72 6e 27 2c 0d
0a 20 20 5d 3b 0d 0a 0d  0a 20 20 63 6f 6e 73 6f
6c 65 2e 6c 6f 67 28 27  5b 56 6f 69 63 65 43 6c
6f 6e 65 5d 20 49 6e 73  74 61 6c 6c 69 6e 67 20
50 79 54 6f 72 63 68 20  2b 20 64 65 70 73 20 77
69 74 68 20 75 76 2e 2e  2e 27 29 3b 0d 0a 20 20
61 77 61 69 74 20 72 75  6e 43 6f 6d 6d 61 6e 64
28 0d 0a 20 20 20 20 75  76 50 61 74 68 2c 0d 0a
20 20 20 20 5b 27 70 69  70 27 2c 20 27 69 6e 73
74 61 6c 6c 27 2c 20 27  2d 2d 70 79 74 68 6f 6e
27 2c 20 70 79 74 68 6f  6e 50 61 74 68 2c 20 27
2d 2d 65 78 74 72 61 2d  69 6e 64 65 78 2d 75 72
6c 27 2c 20 65 78 74 72  61 49 6e 64 65 78 55 72
6c 2c 20 2e 2e 2e 70 61  63 6b 61 67 65 73 5d 2c
0d 0a 20 20 20 20 7b 20  73 68 65 6c 6c 3a 20 74
72 75 65 20 7d 0d 0a 20  20 29 3b 0d 0a 0d 0a 20
20 63 6f 6e 73 6f 6c 65  2e 6c 6f 67 28 27 5b 56
6f 69 63 65 43 6c 6f 6e  65 5d 20 49 6e 73 74 61
6c 6c 69 6e 67 20 66 35  2d 74 74 73 20 66 72 6f
6d 20 6c 6f 63 61 6c 20  73 6f 75 72 63 65 2e 2e
2e 27 29 3b 0d 0a 20 20  61 77 61 69 74 20 72 75
6e 43 6f 6d 6d 61 6e 64  28 0d 0a 20 20 20 20 75
76 50 61 74 68 2c 0d 0a  20 20 20 20 5b 27 70 69
70 27 2c 20 27 69 6e 73  74 61 6c 6c 27 2c 20 27
2d 2d 70 79 74 68 6f 6e  27 2c 20 70 79 74 68 6f
6e 50 61 74 68 2c 20 66  35 54 74 73 4c 6f 63 61
6c 50 61 74 68 5d 2c 0d  0a 20 20 20 20 7b 20 73
68 65 6c 6c 3a 20 74 72  75 65 20 7d 0d 0a 20 20
29 3b 0d 0a 0d 0a 20 20  66 73 2e 77 72 69 74 65
46 69 6c 65 53 79 6e 63  28 6d 61 72 6b 65 72 2c
20 4a 53 4f 4e 2e 73 74  72 69 6e 67 69 66 79 28
7b 20 72 65 61 64 79 3a  20 74 72 75 65 2c 20 61
74 3a 20 6e 65 77 20 44  61 74 65 28 29 2e 74 6f
49 53 4f 53 74 72 69 6e  67 28 29 20 7d 2c 20 6e
75 6c 6c 2c 20 32 29 29  3b 0d 0a 20 20 63 6f 6e
73 6f 6c 65 2e 6c 6f 67  28 27 5b 56 6f 69 63 65
43 6c 6f 6e 65 5d 20 52  75 6e 74 69 6d 65 20 73
65 74 75 70 20 63 6f 6d  70 6c 65 74 65 2e 27 29
3b 0d 0a 7d 0d 0a 0d 0a  61 73 79 6e 63 20 66 75
6e 63 74 69 6f 6e 20 73  74 61 72 74 56 6f 69 63
65 43 6c 6f 6e 65 53 65  72 76 65 72 28 29 20 7b
0d 0a 20 20 63 6f 6e 73  74 20 76 65 6e 76 44 69
72 20 3d 20 67 65 74 56  65 6e 76 44 69 72 28 29
3b 0d 0a 20 20 63 6f 6e  73 74 20 6d 61 72 6b 65
72 20 3d 20 70 61 74 68  2e 6a 6f 69 6e 28 76 65
6e 76 44 69 72 2c 20 27  2e 72 65 61 64 79 2e 6a
73 6f 6e 27 29 3b 0d 0a  20 20 69 66 20 28 21 66
73 2e 65 78 69 73 74 73  53 79 6e 63 28 6d 61 72
6b 65 72 29 29 20 7b 0d  0a 20 20 20 20 63 6f 6e
73 6f 6c 65 2e 6c 6f 67  28 27 5b 56 6f 69 63 65
43 6c 6f 6e 65 5d 20 52  75 6e 74 69 6d 65 20 6e
6f 74 20 73 65 74 20 75  70 20 79 65 74 20 e2 80
94 20 73 6b 69 70 70 69  6e 67 20 61 75 74 6f 2d
73 74 61 72 74 2e 20 55  73 65 20 74 68 65 20 55
49 20 74 6f 20 73 65 74  20 75 70 2e 27 29 3b 0d
0a 20 20 20 20 72 65 74  75 72 6e 3b 0d 0a 20 20
7d 0d 0a 0d 0a 20 20 63  6f 6e 73 74 20 70 79 74
68 6f 6e 50 61 74 68 20  3d 20 70 61 74 68 2e 6a
6f 69 6e 28 76 65 6e 76  44 69 72 2c 20 27 53 63
72 69 70 74 73 27 2c 20  27 70 79 74 68 6f 6e 2e
65 78 65 27 29 3b 0d 0a  20 20 63 6f 6e 73 74 20
73 65 72 76 65 72 50 61  74 68 20 3d 20 67 65 74
56 6f 69 63 65 43 6c 6f  6e 65 53 65 72 76 65 72
50 61 74 68 28 29 3b 0d  0a 20 20 63 6f 6e 73 74
20 61 73 73 65 74 73 52  6f 6f 74 20 3d 20 67 65
74 41 73 73 65 74 73 52  6f 6f 74 28 29 3b 0d 0a
20 20 63 6f 6e 73 74 20  76 6f 69 63 65 73 4a 73
6f 6e 20 3d 20 67 65 74  56 6f 69 63 65 73 4a 73
6f 6e 50 61 74 68 28 29  3b 0d 0a 0d 0a 20 20 69
66 20 28 21 66 73 2e 65  78 69 73 74 73 53 79 6e
63 28 73 65 72 76 65 72  50 61 74 68 29 29 20 7b
0d 0a 20 20 20 20 63 6f  6e 73 6f 6c 65 2e 65 72
72 6f 72 28 27 5b 56 6f  69 63 65 43 6c 6f 6e 65
5d 20 53 65 72 76 65 72  20 73 63 72 69 70 74 20
6e 6f 74 20 66 6f 75 6e  64 3a 27 2c 20 73 65 72
76 65 72 50 61 74 68 29  3b 0d 0a 20 20 20 20 72
65 74 75 72 6e 3b 0d 0a  20 20 7d 0d 0a 0d 0a 20
20 63 6f 6e 73 6f 6c 65  2e 6c 6f 67 28 27 5b 56
6f 69 63 65 43 6c 6f 6e  65 5d 20 53 74 61 72 74
69 6e 67 20 73 65 72 76  65 72 3a 27 2c 20 73 65
72 76 65 72 50 61 74 68  29 3b 0d 0a 20 20 63 6f
6e 73 6f 6c 65 2e 6c 6f  67 28 27 5b 56 6f 69 63
65 43 6c 6f 6e 65 5d 20  50 79 74 68 6f 6e 3a 27
2c 20 70 79 74 68 6f 6e  50 61 74 68 29 3b 0d 0a
20 20 63 6f 6e 73 6f 6c  65 2e 6c 6f 67 28 27 5b
56 6f 69 63 65 43 6c 6f  6e 65 5d 20 41 73 73 65
74 73 3a 27 2c 20 61 73  73 65 74 73 52 6f 6f 74
29 3b 0d 0a 20 20 63 6f  6e 73 6f 6c 65 2e 6c 6f
67 28 27 5b 56 6f 69 63  65 43 6c 6f 6e 65 5d 20
56 6f 69 63 65 73 3a 27  2c 20 76 6f 69 63 65 73
4a 73 6f 6e 29 3b 0d 0a  0d 0a 20 20 76 6f 69 63
65 43 6c 6f 6e 65 53 65  72 76 65 72 50 72 6f 63
65 73 73 20 3d 20 73 70  61 77 6e 28 0d 0a 20 20
20 20 70 79 74 68 6f 6e  50 61 74 68 2c 0d 0a 20
20 20 20 5b 73 65 72 76  65 72 50 61 74 68 2c 20
27 2d 2d 6c 69 73 74 65  6e 27 2c 20 27 2d 2d 70
6f 72 74 27 2c 20 27 38  31 38 38 27 5d 2c 0d 0a
20 20 20 20 7b 0d 0a 20  20 20 20 20 20 73 74 64
69 6f 3a 20 27 69 6e 68  65 72 69 74 27 2c 0d 0a
20 20 20 20 20 20 65 6e  76 3a 20 7b 0d 0a 20 20
20 20 20 20 20 20 2e 2e  2e 70 72 6f 63 65 73 73
2e 65 6e 76 2c 0d 0a 20  20 20 20 20 20 20 20 56
4f 49 43 45 5f 43 4c 4f  4e 45 5f 41 53 53 45 54
53 3a 20 61 73 73 65 74  73 52 6f 6f 74 2c 0d 0a
20 20 20 20 20 20 20 20  56 4f 49 43 45 5f 43 4c
4f 4e 45 5f 56 4f 49 43  45 53 5f 4a 53 4f 4e 3a
20 76 6f 69 63 65 73 4a  73 6f 6e 2c 0d 0a 20 20
20 20 20 20 7d 2c 0d 0a  20 20 20 20 7d 0d 0a 20
20 29 3b 0d 0a 0d 0a 20  20 76 6f 69 63 65 43 6c
6f 6e 65 53 65 72 76 65  72 50 72 6f 63 65 73 73
2e 6f 6e 28 27 65 78 69  74 27 2c 20 28 63 6f 64
65 2c 20 73 69 67 6e 61  6c 29 20 3d 3e 20 7b 0d
0a 20 20 20 20 63 6f 6e  73 6f 6c 65 2e 6c 6f 67
28 27 5b 56 6f 69 63 65  43 6c 6f 6e 65 5d 20 53
65 72 76 65 72 20 65 78  69 74 65 64 3a 27 2c 20
63 6f 64 65 2c 20 73 69  67 6e 61 6c 29 3b 0d 0a
20 20 20 20 76 6f 69 63  65 43 6c 6f 6e 65 53 65
72 76 65 72 50 72 6f 63  65 73 73 20 3d 20 6e 75
6c 6c 3b 0d 0a 20 20 7d  29 3b 0d 0a 7d 0d 0a 0d
0a 61 73 79 6e 63 20 66  75 6e 63 74 69 6f 6e 20
73 74 61 72 74 54 74 73  46 61 73 74 53 65 72 76
65 72 28 29 20 7b 0d 0a  20 20 63 6f 6e 73 74 20
76 65 6e 76 44 69 72 20  3d 20 67 65 74 56 65 6e
76 44 69 72 28 29 3b 0d  0a 20 20 63 6f 6e 73 74
20 6d 61 72 6b 65 72 20  3d 20 70 61 74 68 2e 6a
6f 69 6e 28 76 65 6e 76  44 69 72 2c 20 27 2e 72
65 61 64 79 2e 6a 73 6f  6e 27 29 3b 0d 0a 20 20
69 66 20 28 21 66 73 2e  65 78 69 73 74 73 53 79
6e 63 28 6d 61 72 6b 65  72 29 29 20 7b 0d 0a 20
20 20 20 63 6f 6e 73 6f  6c 65 2e 6c 6f 67 28 27
5b 54 74 73 46 61 73 74  5d 20 52 75 6e 74 69 6d
65 20 6e 6f 74 20 73 65  74 20 75 70 20 79 65 74
20 e2 80 94 20 73 6b 69  70 70 69 6e 67 20 61 75
74 6f 2d 73 74 61 72 74  2e 20 55 73 65 20 56 6f
69 63 65 20 43 6c 6f 6e  65 20 73 65 74 75 70 20
66 69 72 73 74 2e 27 29  3b 0d 0a 20 20 20 20 72
65 74 75 72 6e 3b 0d 0a  20 20 7d 0d 0a 0d 0a 20
20 63 6f 6e 73 74 20 70  79 74 68 6f 6e 50 61 74
68 20 3d 20 70 61 74 68  2e 6a 6f 69 6e 28 76 65
6e 76 44 69 72 2c 20 27  53 63 72 69 70 74 73 27
2c 20 27 70 79 74 68 6f  6e 2e 65 78 65 27 29 3b
0d 0a 20 20 63 6f 6e 73  74 20 73 65 72 76 65 72
50 61 74 68 20 3d 20 67  65 74 54 74 73 46 61 73
74 53 65 72 76 65 72 50  61 74 68 28 29 3b 0d 0a
20 20 63 6f 6e 73 74 20  76 69 65 6e 65 75 52 6f
6f 74 20 3d 20 67 65 74  56 69 65 4e 65 75 54 74
73 52 6f 6f 74 28 29 3b  0d 0a 0d 0a 20 20 69 66
20 28 21 66 73 2e 65 78  69 73 74 73 53 79 6e 63
28 73 65 72 76 65 72 50  61 74 68 29 29 20 7b 0d
0a 20 20 20 20 63 6f 6e  73 6f 6c 65 2e 65 72 72
6f 72 28 27 5b 54 74 73  46 61 73 74 5d 20 53 65
72 76 65 72 20 73 63 72  69 70 74 20 6e 6f 74 20
66 6f 75 6e 64 3a 27 2c  20 73 65 72 76 65 72 50
61 74 68 29 3b 0d 0a 20  20 20 20 72 65 74 75 72
6e 3b 0d 0a 20 20 7d 0d  0a 0d 0a 20 20 63 6f 6e
73 6f 6c 65 2e 6c 6f 67  28 27 5b 54 74 73 46 61
73 74 5d 20 53 74 61 72  74 69 6e 67 20 73 65 72
76 65 72 3a 27 2c 20 73  65 72 76 65 72 50 61 74
68 29 3b 0d 0a 20 20 63  6f 6e 73 6f 6c 65 2e 6c
6f 67 28 27 5b 54 74 73  46 61 73 74 5d 20 50 79
74 68 6f 6e 3a 27 2c 20  70 79 74 68 6f 6e 50 61
74 68 29 3b 0d 0a 20 20  63 6f 6e 73 6f 6c 65 2e
6c 6f 67 28 27 5b 54 74  73 46 61 73 74 5d 20 56
69 65 4e 65 75 20 72 6f  6f 74 3a 27 2c 20 76 69
65 6e 65 75 52 6f 6f 74  29 3b 0d 0a 0d 0a 20 20
74 74 73 46 61 73 74 53  65 72 76 65 72 50 72 6f
63 65 73 73 20 3d 20 73  70 61 77 6e 28 0d 0a 20
20 20 20 70 79 74 68 6f  6e 50 61 74 68 2c 0d 0a
20 20 20 20 5b 73 65 72  76 65 72 50 61 74 68 2c
20 27 2d 2d 6c 69 73 74  65 6e 27 2c 20 27 2d 2d
70 6f 72 74 27 2c 20 27  38 31 38 39 27 5d 2c 0d
0a 20 20 20 20 7b 0d 0a  20 20 20 20 20 20 73 74
64 69 6f 3a 20 27 69 6e  68 65 72 69 74 27 2c 0d
0a 20 20 20 20 20 20 65  6e 76 3a 20 7b 0d 0a 20
20 20 20 20 20 20 20 2e  2e 2e 70 72 6f 63 65 73
73 2e 65 6e 76 2c 0d 0a  20 20 20 20 20 20 20 20
56 49 45 4e 45 55 5f 54  54 53 5f 52 4f 4f 54 3a
20 76 69 65 6e 65 75 52  6f 6f 74 2c 0d 0a 20 20
20 20 20 20 7d 2c 0d 0a  20 20 20 20 7d 0d 0a 20
20 29 3b 0d 0a 0d 0a 20  20 74 74 73 46 61 73 74
53 65 72 76 65 72 50 72  6f 63 65 73 73 2e 6f 6e
28 27 65 78 69 74 27 2c  20 28 63 6f 64 65 2c 20
73 69 67 6e 61 6c 29 20  3d 3e 20 7b 0d 0a 20 20
20 20 63 6f 6e 73 6f 6c  65 2e 6c 6f 67 28 27 5b
54 74 73 46 61 73 74 5d  20 53 65 72 76 65 72 20
65 78 69 74 65 64 3a 27  2c 20 63 6f 64 65 2c 20
73 69 67 6e 61 6c 29 3b  0d 0a 20 20 20 20 74 74
73 46 61 73 74 53 65 72  76 65 72 50 72 6f 63 65
73 73 20 3d 20 6e 75 6c  6c 3b 0d 0a 20 20 7d 29
3b 0d 0a 7d 0d 0a 0d 0a  2f 2f 20 53 65 74 75 70
20 49 50 43 20 68 61 6e  64 6c 65 72 73 0d 0a 66
75 6e 63 74 69 6f 6e 20  73 65 74 75 70 49 70 63
48 61 6e 64 6c 65 72 73  28 29 20 7b 0d 0a 20 20
69 70 63 4d 61 69 6e 2e  68 61 6e 64 6c 65 28 27
64 69 61 6c 6f 67 3a 6f  70 65 6e 27 2c 20 61 73
79 6e 63 20 28 65 76 65  6e 74 2c 20 6f 70 74 69
6f 6e 73 29 20 3d 3e 20  7b 0d 0a 20 20 20 20 72
65 74 75 72 6e 20 64 69  61 6c 6f 67 2e 73 68 6f
77 4f 70 65 6e 44 69 61  6c 6f 67 28 6d 61 69 6e
57 69 6e 64 6f 77 2c 20  6f 70 74 69 6f 6e 73 29
3b 0d 0a 20 20 7d 29 3b  0d 0a 20 20 0d 0a 20 20
69 70 63 4d 61 69 6e 2e  68 61 6e 64 6c 65 28 27
64 69 61 6c 6f 67 3a 73  61 76 65 27 2c 20 61 73
79 6e 63 20 28 65 76 65  6e 74 2c 20 6f 70 74 69
6f 6e 73 29 20 3d 3e 20  7b 0d 0a 20 20 20 20 72
65 74 75 72 6e 20 64 69  61 6c 6f 67 2e 73 68 6f
77 53 61 76 65 44 69 61  6c 6f 67 28 6d 61 69 6e
57 69 6e 64 6f 77 2c 20  6f 70 74 69 6f 6e 73 29
3b 0d 0a 20 20 7d 29 3b  0d 0a 20 20 0d 0a 20 20
69 70 63 4d 61 69 6e 2e  68 61 6e 64 6c 65 28 27
61 70 70 3a 76 65 72 73  69 6f 6e 27 2c 20 61 73
79 6e 63 20 28 29 20 3d  3e 20 7b 0d 0a 20 20 20
20 72 65 74 75 72 6e 20  61 70 70 2e 67 65 74 56
65 72 73 69 6f 6e 28 29  3b 0d 0a 20 20 7d 29 3b
0d 0a 20 20 0d 0a 20 20  69 70 63 4d 61 69 6e 2e
68 61 6e 64 6c 65 28 27  73 68 65 6c 6c 3a 6f 70
65 6e 45 78 74 65 72 6e  61 6c 27 2c 20 61 73 79
6e 63 20 28 65 76 65 6e  74 2c 20 75 72 6c 29 20
3d 3e 20 7b 0d 0a 20 20  20 20 72 65 74 75 72 6e
20 73 68 65 6c 6c 2e 6f  70 65 6e 45 78 74 65 72
6e 61 6c 28 75 72 6c 29  3b 0d 0a 20 20 7d 29 3b
0d 0a 20 20 0d 0a 20 20  2f 2f 20 52 65 6c 61 79
20 6d 65 73 73 61 67 65  73 20 74 6f 20 73 65 72
76 65 72 20 70 72 6f 63  65 73 73 0d 0a 20 20 69
70 63 4d 61 69 6e 2e 68  61 6e 64 6c 65 28 27 73
65 72 76 65 72 3a 73 65  6e 64 27 2c 20 61 73 79
6e 63 20 28 65 76 65 6e  74 2c 20 6e 61 6d 65 2c
20 61 72 67 73 29 20 3d  3e 20 7b 0d 0a 20 20 20
20 72 65 74 75 72 6e 20  73 65 6e 64 54 6f 53 65
72 76 65 72 28 6e 61 6d  65 2c 20 61 72 67 73 29
3b 0d 0a 20 20 7d 29 3b  0d 0a 0d 0a 20 20 69 70
63 4d 61 69 6e 2e 68 61  6e 64 6c 65 28 27 73 65
72 76 69 63 65 73 3a 6c  69 73 74 27 2c 20 61 73
79 6e 63 20 28 29 20 3d  3e 20 7b 0d 0a 20 20 20
20 72 65 74 75 72 6e 20  67 65 74 4d 61 6e 61 67
65 64 53 65 72 76 69 63  65 73 53 74 61 74 75 73
4c 69 73 74 28 29 3b 0d  0a 20 20 7d 29 3b 0d 0a
0d 0a 20 20 69 70 63 4d  61 69 6e 2e 68 61 6e 64
6c 65 28 27 73 65 72 76  69 63 65 73 3a 73 74 61
72 74 27 2c 20 61 73 79  6e 63 20 28 65 76 65 6e
74 2c 20 73 65 72 76 69  63 65 49 64 29 20 3d 3e
20 7b 0d 0a 20 20 20 20  72 65 74 75 72 6e 20 73
74 61 72 74 4d 61 6e 61  67 65 64 53 65 72 76 69
63 65 28 73 65 72 76 69  63 65 49 64 29 3b 0d 0a
20 20 7d 29 3b 0d 0a 0d  0a 20 20 69 70 63 4d 61
69 6e 2e 68 61 6e 64 6c  65 28 27 73 65 72 76 69
63 65 73 3a 73 74 6f 70  27 2c 20 61 73 79 6e 63
20 28 65 76 65 6e 74 2c  20 73 65 72 76 69 63 65
49 64 29 20 3d 3e 20 7b  0d 0a 20 20 20 20 72 65
74 75 72 6e 20 73 74 6f  70 4d 61 6e 61 67 65 64
53 65 72 76 69 63 65 28  73 65 72 76 69 63 65 49
64 29 3b 0d 0a 20 20 7d  29 3b 0d 0a 0d 0a 20 20
69 70 63 4d 61 69 6e 2e  68 61 6e 64 6c 65 28 27
73 65 72 76 69 63 65 73  3a 72 65 73 74 61 72 74
27 2c 20 61 73 79 6e 63  20 28 65 76 65 6e 74 2c
20 73 65 72 76 69 63 65  49 64 29 20 3d 3e 20 7b
0d 0a 20 20 20 20 72 65  74 75 72 6e 20 72 65 73
74 61 72 74 4d 61 6e 61  67 65 64 53 65 72 76 69
63 65 28 73 65 72 76 69  63 65 49 64 29 3b 0d 0a
20 20 7d 29 3b 0d 0a 0d  0a 20 20 2f 2f 20 56 6f
69 63 65 20 43 6c 6f 6e  65 3a 20 63 68 65 63 6b
20 72 75 6e 74 69 6d 65  20 2b 20 73 65 72 76 65
72 20 73 74 61 74 75 73  0d 0a 20 20 69 70 63 4d
61 69 6e 2e 68 61 6e 64  6c 65 28 27 76 6f 69 63
65 2d 63 6c 6f 6e 65 3a  73 74 61 74 75 73 27 2c
20 61 73 79 6e 63 20 28  29 20 3d 3e 20 7b 0d 0a
20 20 20 20 63 6f 6e 73  74 20 76 65 6e 76 44 69
72 20 3d 20 67 65 74 56  65 6e 76 44 69 72 28 29
3b 0d 0a 20 20 20 20 63  6f 6e 73 74 20 6d 61 72
6b 65 72 20 3d 20 70 61  74 68 2e 6a 6f 69 6e 28
76 65 6e 76 44 69 72 2c  20 27 2e 72 65 61 64 79
2e 6a 73 6f 6e 27 29 3b  0d 0a 20 20 20 20 63 6f
6e 73 74 20 72 75 6e 74  69 6d 65 52 65 61 64 79
20 3d 20 66 73 2e 65 78  69 73 74 73 53 79 6e 63
28 6d 61 72 6b 65 72 29  3b 0d 0a 20 20 20 20 63
6f 6e 73 74 20 73 65 72  76 65 72 52 75 6e 6e 69
6e 67 20 3d 20 76 6f 69  63 65 43 6c 6f 6e 65 53
65 72 76 65 72 50 72 6f  63 65 73 73 20 21 3d 3d
20 6e 75 6c 6c 3b 0d 0a  20 20 20 20 63 6f 6e 73
74 20 61 70 70 64 61 74  61 20 3d 20 70 72 6f 63
65 73 73 2e 65 6e 76 2e  41 50 50 44 41 54 41 20
7c 7c 20 70 61 74 68 2e  6a 6f 69 6e 28 72 65 71
75 69 72 65 28 27 6f 73  27 29 2e 68 6f 6d 65 64
69 72 28 29 2c 20 27 2e  63 6f 6e 66 69 67 27 29
3b 0d 0a 20 20 20 20 63  6f 6e 73 74 20 6d 6f 64
65 6c 44 69 72 20 3d 20  70 61 74 68 2e 6a 6f 69
6e 28 61 70 70 64 61 74  61 2c 20 27 70 73 69 2d
61 69 2d 63 6f 6e 74 65  6e 74 2d 68 75 62 27 2c
20 27 6d 6f 64 65 6c 73  27 2c 20 27 66 35 2d 74
74 73 27 29 3b 0d 0a 20  20 20 20 72 65 74 75 72
6e 20 7b 0d 0a 20 20 20  20 20 20 72 75 6e 74 69
6d 65 5f 72 65 61 64 79  3a 20 72 75 6e 74 69 6d
65 52 65 61 64 79 2c 0d  0a 20 20 20 20 20 20 73
65 72 76 65 72 5f 72 75  6e 6e 69 6e 67 3a 20 73
65 72 76 65 72 52 75 6e  6e 69 6e 67 2c 0d 0a 20
20 20 20 20 20 76 65 6e  76 5f 70 61 74 68 3a 20
76 65 6e 76 44 69 72 2c  0d 0a 20 20 20 20 20 20
6d 6f 64 65 6c 5f 70 61  74 68 3a 20 6d 6f 64 65
6c 44 69 72 2c 0d 0a 20  20 20 20 7d 3b 0d 0a 20
20 7d 29 3b 0d 0a 0d 0a  20 20 2f 2f 20 56 6f 69
63 65 20 43 6c 6f 6e 65  3a 20 63 6c 65 61 6e 20
76 65 6e 76 20 66 6f 72  20 66 72 65 73 68 20 69
6e 73 74 61 6c 6c 0d 0a  20 20 69 70 63 4d 61 69
6e 2e 68 61 6e 64 6c 65  28 27 76 6f 69 63 65 2d
63 6c 6f 6e 65 3a 63 6c  65 61 6e 27 2c 20 61 73
79 6e 63 20 28 29 20 3d  3e 20 7b 0d 0a 20 20 20
20 63 6f 6e 73 74 20 76  65 6e 76 44 69 72 20 3d
20 67 65 74 56 65 6e 76  44 69 72 28 29 3b 0d 0a
20 20 20 20 69 66 20 28  76 6f 69 63 65 43 6c 6f
6e 65 53 65 72 76 65 72  50 72 6f 63 65 73 73 29
20 7b 0d 0a 20 20 20 20  20 20 63 6f 6e 73 6f 6c
65 2e 6c 6f 67 28 27 5b  56 6f 69 63 65 43 6c 6f
6e 65 5d 20 53 74 6f 70  70 69 6e 67 20 73 65 72
76 65 72 20 62 65 66 6f  72 65 20 63 6c 65 61 6e
75 70 2e 2e 2e 27 29 3b  0d 0a 20 20 20 20 20 20
76 6f 69 63 65 43 6c 6f  6e 65 53 65 72 76 65 72
50 72 6f 63 65 73 73 2e  6b 69 6c 6c 28 29 3b 0d
0a 20 20 20 20 20 20 76  6f 69 63 65 43 6c 6f 6e
65 53 65 72 76 65 72 50  72 6f 63 65 73 73 20 3d
20 6e 75 6c 6c 3b 0d 0a  20 20 20 20 7d 0d 0a 20
20 20 20 69 66 20 28 66  73 2e 65 78 69 73 74 73
53 79 6e 63 28 76 65 6e  76 44 69 72 29 29 20 7b
0d 0a 20 20 20 20 20 20  63 6f 6e 73 6f 6c 65 2e
6c 6f 67 28 27 5b 56 6f  69 63 65 43 6c 6f 6e 65
5d 20 52 65 6d 6f 76 69  6e 67 20 76 65 6e 76 3a
27 2c 20 76 65 6e 76 44  69 72 29 3b 0d 0a 20 20
20 20 20 20 66 73 2e 72  6d 53 79 6e 63 28 76 65
6e 76 44 69 72 2c 20 7b  20 72 65 63 75 72 73 69
76 65 3a 20 74 72 75 65  2c 20 66 6f 72 63 65 3a
20 74 72 75 65 20 7d 29  3b 0d 0a 20 20 20 20 20
20 63 6f 6e 73 6f 6c 65  2e 6c 6f 67 28 27 5b 56
6f 69 63 65 43 6c 6f 6e  65 5d 20 56 65 6e 76 20
72 65 6d 6f 76 65 64 2e  27 29 3b 0d 0a 20 20 20
20 20 20 72 65 74 75 72  6e 20 7b 20 73 75 63 63
65 73 73 3a 20 74 72 75  65 2c 20 6d 65 73 73 61
67 65 3a 20 27 56 69 72  74 75 61 6c 20 65 6e 76
69 72 6f 6e 6d 65 6e 74  20 72 65 6d 6f 76 65 64
2e 27 20 7d 3b 0d 0a 20  20 20 20 7d 0d 0a 20 20
20 20 72 65 74 75 72 6e  20 7b 20 73 75 63 63 65
73 73 3a 20 74 72 75 65  2c 20 6d 65 73 73 61 67
65 3a 20 27 4e 6f 20 76  69 72 74 75 61 6c 20 65
6e 76 69 72 6f 6e 6d 65  6e 74 20 66 6f 75 6e 64
2e 27 20 7d 3b 0d 0a 20  20 7d 29 3b 0d 0a 0d 0a
20 20 2f 2f 20 46 61 73  74 20 54 54 53 3a 20 63
68 65 63 6b 20 73 65 72  76 65 72 20 73 74 61 74
75 73 0d 0a 20 20 69 70  63 4d 61 69 6e 2e 68 61
6e 64 6c 65 28 27 74 74  73 2d 66 61 73 74 3a 73
74 61 74 75 73 27 2c 20  61 73 79 6e 63 20 28 29
20 3d 3e 20 7b 0d 0a 20  20 20 20 63 6f 6e 73 74
20 76 65 6e 76 44 69 72  20 3d 20 67 65 74 56 65
6e 76 44 69 72 28 29 3b  0d 0a 20 20 20 20 63 6f
6e 73 74 20 6d 61 72 6b  65 72 20 3d 20 70 61 74
68 2e 6a 6f 69 6e 28 76  65 6e 76 44 69 72 2c 20
27 2e 72 65 61 64 79 2e  6a 73 6f 6e 27 29 3b 0d
0a 20 20 20 20 63 6f 6e  73 74 20 72 75 6e 74 69
6d 65 52 65 61 64 79 20  3d 20 66 73 2e 65 78 69
73 74 73 53 79 6e 63 28  6d 61 72 6b 65 72 29 3b
0d 0a 20 20 20 20 63 6f  6e 73 74 20 73 65 72 76
65 72 52 75 6e 6e 69 6e  67 20 3d 20 74 74 73 46
61 73 74 53 65 72 76 65  72 50 72 6f 63 65 73 73
20 21 3d 3d 20 6e 75 6c  6c 3b 0d 0a 20 20 20 20
72 65 74 75 72 6e 20 7b  0d 0a 20 20 20 20 20 20
72 75 6e 74 69 6d 65 5f  72 65 61 64 79 3a 20 72
75 6e 74 69 6d 65 52 65  61 64 79 2c 0d 0a 20 20
20 20 20 20 73 65 72 76  65 72 5f 72 75 6e 6e 69
6e 67 3a 20 73 65 72 76  65 72 52 75 6e 6e 69 6e
67 2c 0d 0a 20 20 20 20  20 20 76 69 65 6e 65 75
5f 72 6f 6f 74 3a 20 67  65 74 56 69 65 4e 65 75
54 74 73 52 6f 6f 74 28  29 2c 0d 0a 20 20 20 20
7d 3b 0d 0a 20 20 7d 29  3b 0d 0a 0d 0a 20 20 2f
2f 20 46 61 73 74 20 54  54 53 3a 20 73 74 61 72
74 20 73 65 72 76 65 72  20 69 66 20 6e 6f 74 20
72 75 6e 6e 69 6e 67 0d  0a 20 20 69 70 63 4d 61
69 6e 2e 68 61 6e 64 6c  65 28 27 74 74 73 2d 66
61 73 74 3a 73 74 61 72  74 2d 73 65 72 76 65 72
27 2c 20 61 73 79 6e 63  20 28 29 20 3d 3e 20 7b
0d 0a 20 20 20 20 69 66  20 28 74 74 73 46 61 73
74 53 65 72 76 65 72 50  72 6f 63 65 73 73 29 20
7b 0d 0a 20 20 20 20 20  20 72 65 74 75 72 6e 20
7b 20 73 75 63 63 65 73  73 3a 20 74 72 75 65 2c
20 6d 65 73 73 61 67 65  3a 20 27 53 65 72 76 65
72 20 61 6c 72 65 61 64  79 20 72 75 6e 6e 69 6e
67 27 20 7d 3b 0d 0a 20  20 20 20 7d 0d 0a 20 20
20 20 74 72 79 20 7b 0d  0a 20 20 20 20 20 20 61
77 61 69 74 20 73 74 61  72 74 54 74 73 46 61 73
74 53 65 72 76 65 72 28  29 3b 0d 0a 20 20 20 20
20 20 72 65 74 75 72 6e  20 7b 20 73 75 63 63 65
73 73 3a 20 74 72 75 65  2c 20 6d 65 73 73 61 67
65 3a 20 27 53 65 72 76  65 72 20 73 74 61 72 74
65 64 27 20 7d 3b 0d 0a  20 20 20 20 7d 20 63 61
74 63 68 20 28 65 72 72  29 20 7b 0d 0a 20 20 20
20 20 20 72 65 74 75 72  6e 20 7b 20 73 75 63 63
65 73 73 3a 20 66 61 6c  73 65 2c 20 65 72 72 6f
72 3a 20 65 72 72 2e 6d  65 73 73 61 67 65 20 7d
3b 0d 0a 20 20 20 20 7d  0d 0a 20 20 7d 29 3b 0d
0a 0d 0a 20 20 2f 2f 20  46 61 73 74 20 54 54 53
3a 20 73 74 6f 70 20 73  65 72 76 65 72 0d 0a 20
20 69 70 63 4d 61 69 6e  2e 68 61 6e 64 6c 65 28
27 74 74 73 2d 66 61 73  74 3a 73 74 6f 70 2d 73
65 72 76 65 72 27 2c 20  61 73 79 6e 63 20 28 29
20 3d 3e 20 7b 0d 0a 20  20 20 20 69 66 20 28 74
74 73 46 61 73 74 53 65  72 76 65 72 50 72 6f 63
65 73 73 29 20 7b 0d 0a  20 20 20 20 20 20 74 74
73 46 61 73 74 53 65 72  76 65 72 50 72 6f 63 65
73 73 2e 6b 69 6c 6c 28  29 3b 0d 0a 20 20 20 20
20 20 74 74 73 46 61 73  74 53 65 72 76 65 72 50
72 6f 63 65 73 73 20 3d  20 6e 75 6c 6c 3b 0d 0a
20 20 20 20 20 20 72 65  74 75 72 6e 20 7b 20 73
75 63 63 65 73 73 3a 20  74 72 75 65 2c 20 6d 65
73 73 61 67 65 3a 20 27  53 65 72 76 65 72 20 73
74 6f 70 70 65 64 27 20  7d 3b 0d 0a 20 20 20 20
7d 0d 0a 20 20 20 20 72  65 74 75 72 6e 20 7b 20
73 75 63 63 65 73 73 3a  20 74 72 75 65 2c 20 6d
65 73 73 61 67 65 3a 20  27 53 65 72 76 65 72 20
77 61 73 20 6e 6f 74 20  72 75 6e 6e 69 6e 67 27
20 7d 3b 0d 0a 20 20 7d  29 3b 0d 0a 0d 0a 20 20
2f 2f 20 56 6f 69 63 65  20 43 6c 6f 6e 65 3a 20
69 6e 73 74 61 6c 6c 20  72 75 6e 74 69 6d 65 20
28 76 65 6e 76 20 2b 20  64 65 70 73 29 2c 20 74
68 65 6e 20 73 74 61 72  74 20 73 65 72 76 65 72
0d 0a 20 20 69 70 63 4d  61 69 6e 2e 68 61 6e 64
6c 65 28 27 76 6f 69 63  65 2d 63 6c 6f 6e 65 3a
73 65 74 75 70 27 2c 20  61 73 79 6e 63 20 28 65
76 65 6e 74 29 20 3d 3e  20 7b 0d 0a 20 20 20 20
63 6f 6e 73 74 20 73 65  74 75 70 4c 6f 67 73 20
3d 20 5b 5d 3b 0d 0a 20  20 20 20 63 6f 6e 73 74
20 73 65 6e 64 50 72 6f  67 72 65 73 73 20 3d 20
28 64 61 74 61 29 20 3d  3e 20 7b 0d 0a 20 20 20
20 20 20 69 66 20 28 6d  61 69 6e 57 69 6e 64 6f
77 20 26 26 20 21 6d 61  69 6e 57 69 6e 64 6f 77
2e 69 73 44 65 73 74 72  6f 79 65 64 28 29 29 20
7b 0d 0a 20 20 20 20 20  20 20 20 6d 61 69 6e 57
69 6e 64 6f 77 2e 77 65  62 43 6f 6e 74 65 6e 74
73 2e 73 65 6e 64 28 27  76 6f 69 63 65 2d 63 6c
6f 6e 65 3a 73 65 74 75  70 2d 70 72 6f 67 72 65
73 73 27 2c 20 7b 20 2e  2e 2e 64 61 74 61 2c 20
6c 6f 67 73 3a 20 73 65  74 75 70 4c 6f 67 73 2e
73 6c 69 63 65 28 29 20  7d 29 3b 0d 0a 20 20 20
20 20 20 7d 0d 0a 20 20  20 20 7d 3b 0d 0a 20 20
20 20 63 6f 6e 73 74 20  6c 6f 67 20 3d 20 28 6c
69 6e 65 29 20 3d 3e 20  7b 0d 0a 20 20 20 20 20
20 63 6f 6e 73 6f 6c 65  2e 6c 6f 67 28 27 5b 56
6f 69 63 65 43 6c 6f 6e  65 3a 53 65 74 75 70 5d
27 2c 20 6c 69 6e 65 29  3b 0d 0a 20 20 20 20 20
20 73 65 74 75 70 4c 6f  67 73 2e 70 75 73 68 28
6c 69 6e 65 29 3b 0d 0a  20 20 20 20 20 20 69 66
20 28 73 65 74 75 70 4c  6f 67 73 2e 6c 65 6e 67
74 68 20 3e 20 32 30 30  29 20 73 65 74 75 70 4c
6f 67 73 2e 73 68 69 66  74 28 29 3b 0d 0a 20 20
20 20 7d 3b 0d 0a 0d 0a  20 20 20 20 74 72 79 20
7b 0d 0a 20 20 20 20 20  20 63 6f 6e 73 74 20 76
65 6e 76 44 69 72 20 3d  20 67 65 74 56 65 6e 76
44 69 72 28 29 3b 0d 0a  20 20 20 20 20 20 63 6f
6e 73 74 20 6d 61 72 6b  65 72 20 3d 20 70 61 74
68 2e 6a 6f 69 6e 28 76  65 6e 76 44 69 72 2c 20
27 2e 72 65 61 64 79 2e  6a 73 6f 6e 27 29 3b 0d
0a 0d 0a 20 20 20 20 20  20 69 66 20 28 66 73 2e
65 78 69 73 74 73 53 79  6e 63 28 6d 61 72 6b 65
72 29 29 20 7b 0d 0a 20  20 20 20 20 20 20 20 6c
6f 67 28 27 52 75 6e 74  69 6d 65 20 61 6c 72 65
61 64 79 20 69 6e 73 74  61 6c 6c 65 64 2e 27 29
3b 0d 0a 20 20 20 20 20  20 20 20 73 65 6e 64 50
72 6f 67 72 65 73 73 28  7b 20 73 74 61 74 75 73
3a 20 27 63 6f 6d 70 6c  65 74 65 27 2c 20 70 65
72 63 65 6e 74 3a 20 31  30 30 2c 20 6d 65 73 73
61 67 65 3a 20 27 52 75  6e 74 69 6d 65 20 61 6c
72 65 61 64 79 20 69 6e  73 74 61 6c 6c 65 64 2e
27 20 7d 29 3b 0d 0a 20  20 20 20 20 20 20 20 69
66 20 28 21 76 6f 69 63  65 43 6c 6f 6e 65 53 65
72 76 65 72 50 72 6f 63  65 73 73 29 20 61 77 61
69 74 20 73 74 61 72 74  56 6f 69 63 65 43 6c 6f
6e 65 53 65 72 76 65 72  28 29 3b 0d 0a 20 20 20
20 20 20 20 20 72 65 74  75 72 6e 20 7b 20 73 75
63 63 65 73 73 3a 20 74  72 75 65 20 7d 3b 0d 0a
20 20 20 20 20 20 7d 0d  0a 0d 0a 20 20 20 20 20
20 63 6f 6e 73 74 20 75  76 50 61 74 68 20 3d 20
67 65 74 55 76 50 61 74  68 28 29 3b 0d 0a 0d 0a
20 20 20 20 20 20 2f 2f  20 53 74 65 70 20 31 3a
20 43 72 65 61 74 65 20  76 65 6e 76 20 28 72 65
6d 6f 76 65 20 70 61 72  74 69 61 6c 20 6c 65 66
74 6f 76 65 72 73 20 66  69 72 73 74 29 0d 0a 20
20 20 20 20 20 6c 6f 67  28 27 43 72 65 61 74 69
6e 67 20 50 79 74 68 6f  6e 20 76 69 72 74 75 61
6c 20 65 6e 76 69 72 6f  6e 6d 65 6e 74 20 61 74
3a 20 27 20 2b 20 76 65  6e 76 44 69 72 29 3b 0d
0a 20 20 20 20 20 20 73  65 6e 64 50 72 6f 67 72
65 73 73 28 7b 20 73 74  61 74 75 73 3a 20 27 69
6e 73 74 61 6c 6c 69 6e  67 27 2c 20 70 65 72 63
65 6e 74 3a 20 35 2c 20  6d 65 73 73 61 67 65 3a
20 27 43 72 65 61 74 69  6e 67 20 50 79 74 68 6f
6e 20 76 69 72 74 75 61  6c 20 65 6e 76 69 72 6f
6e 6d 65 6e 74 2e 2e 2e  27 20 7d 29 3b 0d 0a 20
20 20 20 20 20 69 66 20  28 66 73 2e 65 78 69 73
74 73 53 79 6e 63 28 76  65 6e 76 44 69 72 29 29
20 7b 0d 0a 20 20 20 20  20 20 20 20 6c 6f 67 28
27 52 65 6d 6f 76 69 6e  67 20 65 78 69 73 74 69
6e 67 20 70 61 72 74 69  61 6c 20 76 65 6e 76 2e
2e 2e 27 29 3b 0d 0a 20  20 20 20 20 20 20 20 66
73 2e 72 6d 53 79 6e 63  28 76 65 6e 76 44 69 72
2c 20 7b 20 72 65 63 75  72 73 69 76 65 3a 20 74
72 75 65 2c 20 66 6f 72  63 65 3a 20 74 72 75 65
20 7d 29 3b 0d 0a 20 20  20 20 20 20 7d 0d 0a 20
20 20 20 20 20 61 77 61  69 74 20 72 75 6e 43 6f
6d 6d 61 6e 64 57 69 74  68 50 72 6f 67 72 65 73
73 28 75 76 50 61 74 68  2c 20 5b 27 76 65 6e 76
27 2c 20 76 65 6e 76 44  69 72 5d 2c 20 7b 20 73
68 65 6c 6c 3a 20 74 72  75 65 20 7d 2c 20 28 6c
69 6e 65 29 20 3d 3e 20  7b 0d 0a 20 20 20 20 20
20 20 20 6c 6f 67 28 6c  69 6e 65 29 3b 0d 0a 20
20 20 20 20 20 20 20 73  65 6e 64 50 72 6f 67 72
65 73 73 28 7b 20 73 74  61 74 75 73 3a 20 27 69
6e 73 74 61 6c 6c 69 6e  67 27 2c 20 70 65 72 63
65 6e 74 3a 20 31 30 2c  20 6d 65 73 73 61 67 65
3a 20 6c 69 6e 65 20 7d  29 3b 0d 0a 20 20 20 20
20 20 7d 29 3b 0d 0a 20  20 20 20 20 20 6c 6f 67
28 27 56 65 6e 76 20 63  72 65 61 74 65 64 20 73
75 63 63 65 73 73 66 75  6c 6c 79 2e 27 29 3b 0d
0a 0d 0a 20 20 20 20 20  20 63 6f 6e 73 74 20 70
79 74 68 6f 6e 50 61 74  68 20 3d 20 70 61 74 68
2e 6a 6f 69 6e 28 76 65  6e 76 44 69 72 2c 20 27
53 63 72 69 70 74 73 27  2c 20 27 70 79 74 68 6f
6e 2e 65 78 65 27 29 3b  0d 0a 20 20 20 20 20 20
63 6f 6e 73 74 20 65 78  74 72 61 49 6e 64 65 78
55 72 6c 20 3d 20 27 68  74 74 70 73 3a 2f 2f 64
6f 77 6e 6c 6f 61 64 2e  70 79 74 6f 72 63 68 2e
6f 72 67 2f 77 68 6c 2f  63 75 31 32 34 27 3b 0d
0a 20 20 20 20 20 20 63  6f 6e 73 74 20 70 61 63
6b 61 67 65 73 20 3d 20  5b 27 74 6f 72 63 68 3d
3d 32 2e 34 2e 30 2b 63  75 31 32 34 27 2c 20 27
74 6f 72 63 68 61 75 64  69 6f 3d 3d 32 2e 34 2e
30 2b 63 75 31 32 34 27  2c 20 27 66 61 73 74 61
70 69 27 2c 20 27 75 76  69 63 6f 72 6e 27 5d 3b
0d 0a 0d 0a 20 20 20 20  20 20 2f 2f 20 53 74 65
70 20 32 3a 20 49 6e 73  74 61 6c 6c 20 50 79 54
6f 72 63 68 20 2b 20 64  65 70 73 0d 0a 20 20 20
20 20 20 6c 6f 67 28 27  49 6e 73 74 61 6c 6c 69
6e 67 3a 20 27 20 2b 20  70 61 63 6b 61 67 65 73
2e 6a 6f 69 6e 28 27 2c  20 27 29 29 3b 0d 0a 20
20 20 20 20 20 6c 6f 67  28 27 45 78 74 72 61 20
69 6e 64 65 78 3a 20 27  20 2b 20 65 78 74 72 61
49 6e 64 65 78 55 72 6c  29 3b 0d 0a 20 20 20 20
20 20 73 65 6e 64 50 72  6f 67 72 65 73 73 28 7b
20 73 74 61 74 75 73 3a  20 27 69 6e 73 74 61 6c
6c 69 6e 67 27 2c 20 70  65 72 63 65 6e 74 3a 20
31 35 2c 20 6d 65 73 73  61 67 65 3a 20 27 49 6e
73 74 61 6c 6c 69 6e 67  20 50 79 54 6f 72 63 68
20 2b 20 64 65 70 65 6e  64 65 6e 63 69 65 73 20
28 74 68 69 73 20 6d 61  79 20 74 61 6b 65 20 61
20 77 68 69 6c 65 29 2e  2e 2e 27 20 7d 29 3b 0d
0a 20 20 20 20 20 20 61  77 61 69 74 20 72 75 6e
43 6f 6d 6d 61 6e 64 57  69 74 68 50 72 6f 67 72
65 73 73 28 0d 0a 20 20  20 20 20 20 20 20 75 76
50 61 74 68 2c 0d 0a 20  20 20 20 20 20 20 20 5b
27 70 69 70 27 2c 20 27  69 6e 73 74 61 6c 6c 27
2c 20 27 2d 2d 70 79 74  68 6f 6e 27 2c 20 70 79
74 68 6f 6e 50 61 74 68  2c 20 27 2d 2d 65 78 74
72 61 2d 69 6e 64 65 78  2d 75 72 6c 27 2c 20 65
78 74 72 61 49 6e 64 65  78 55 72 6c 2c 20 2e 2e
2e 70 61 63 6b 61 67 65  73 5d 2c 0d 0a 20 20 20
20 20 20 20 20 7b 20 73  68 65 6c 6c 3a 20 74 72
75 65 20 7d 2c 0d 0a 20  20 20 20 20 20 20 20 28
6c 69 6e 65 29 20 3d 3e  20 7b 0d 0a 20 20 20 20
20 20 20 20 20 20 6c 6f  67 28 6c 69 6e 65 29 3b
0d 0a 20 20 20 20 20 20  20 20 20 20 73 65 6e 64
50 72 6f 67 72 65 73 73  28 7b 20 73 74 61 74 75
73 3a 20 27 69 6e 73 74  61 6c 6c 69 6e 67 27 2c
20 70 65 72 63 65 6e 74  3a 20 34 30 2c 20 6d 65
73 73 61 67 65 3a 20 6c  69 6e 65 20 7d 29 3b 0d
0a 20 20 20 20 20 20 20  20 7d 0d 0a 20 20 20 20
20 20 29 3b 0d 0a 20 20  20 20 20 20 6c 6f 67 28
27 50 79 54 6f 72 63 68  20 2b 20 64 65 70 73 20
69 6e 73 74 61 6c 6c 65  64 20 73 75 63 63 65 73
73 66 75 6c 6c 79 2e 27  29 3b 0d 0a 0d 0a 20 20
20 20 20 20 2f 2f 20 53  74 65 70 20 33 3a 20 49
6e 73 74 61 6c 6c 20 66  35 2d 74 74 73 20 66 72
6f 6d 20 6c 6f 63 61 6c  20 73 6f 75 72 63 65 0d
0a 20 20 20 20 20 20 63  6f 6e 73 74 20 66 35 54
74 73 4c 6f 63 61 6c 50  61 74 68 20 3d 20 67 65
74 41 73 73 65 74 73 52  6f 6f 74 28 29 3b 0d 0a
20 20 20 20 20 20 6c 6f  67 28 27 49 6e 73 74 61
6c 6c 69 6e 67 20 46 35  2d 54 54 53 20 66 72 6f
6d 3a 20 27 20 2b 20 66  35 54 74 73 4c 6f 63 61
6c 50 61 74 68 29 3b 0d  0a 20 20 20 20 20 20 73
65 6e 64 50 72 6f 67 72  65 73 73 28 7b 20 73 74
61 74 75 73 3a 20 27 69  6e 73 74 61 6c 6c 69 6e
67 27 2c 20 70 65 72 63  65 6e 74 3a 20 37 30 2c
20 6d 65 73 73 61 67 65  3a 20 27 49 6e 73 74 61
6c 6c 69 6e 67 20 46 35  2d 54 54 53 20 66 72 6f
6d 20 6c 6f 63 61 6c 20  73 6f 75 72 63 65 2e 2e
2e 27 20 7d 29 3b 0d 0a  20 20 20 20 20 20 61 77
61 69 74 20 72 75 6e 43  6f 6d 6d 61 6e 64 57 69
74 68 50 72 6f 67 72 65  73 73 28 0d 0a 20 20 20
20 20 20 20 20 75 76 50  61 74 68 2c 0d 0a 20 20
20 20 20 20 20 20 5b 27  70 69 70 27 2c 20 27 69
6e 73 74 61 6c 6c 27 2c  20 27 2d 2d 70 79 74 68
6f 6e 27 2c 20 70 79 74  68 6f 6e 50 61 74 68 2c
20 66 35 54 74 73 4c 6f  63 61 6c 50 61 74 68 5d
2c 0d 0a 20 20 20 20 20  20 20 20 7b 20 73 68 65
6c 6c 3a 20 74 72 75 65  20 7d 2c 0d 0a 20 20 20
20 20 20 20 20 28 6c 69  6e 65 29 20 3d 3e 20 7b
0d 0a 20 20 20 20 20 20  20 20 20 20 6c 6f 67 28
6c 69 6e 65 29 3b 0d 0a  20 20 20 20 20 20 20 20
20 20 73 65 6e 64 50 72  6f 67 72 65 73 73 28 7b
20 73 74 61 74 75 73 3a  20 27 69 6e 73 74 61 6c
6c 69 6e 67 27 2c 20 70  65 72 63 65 6e 74 3a 20
38 35 2c 20 6d 65 73 73  61 67 65 3a 20 6c 69 6e
65 20 7d 29 3b 0d 0a 20  20 20 20 20 20 20 20 7d
0d 0a 20 20 20 20 20 20  29 3b 0d 0a 20 20 20 20
20 20 6c 6f 67 28 27 46  35 2d 54 54 53 20 69 6e
73 74 61 6c 6c 65 64 20  73 75 63 63 65 73 73 66
75 6c 6c 79 2e 27 29 3b  0d 0a 0d 0a 20 20 20 20
20 20 2f 2f 20 53 74 65  70 20 34 3a 20 57 72 69
74 65 20 6d 61 72 6b 65  72 0d 0a 20 20 20 20 20
20 66 73 2e 77 72 69 74  65 46 69 6c 65 53 79 6e
63 28 6d 61 72 6b 65 72  2c 20 4a 53 4f 4e 2e 73
74 72 69 6e 67 69 66 79  28 7b 20 72 65 61 64 79
3a 20 74 72 75 65 2c 20  61 74 3a 20 6e 65 77 20
44 61 74 65 28 29 2e 74  6f 49 53 4f 53 74 72 69
6e 67 28 29 20 7d 2c 20  6e 75 6c 6c 2c 20 32 29
29 3b 0d 0a 20 20 20 20  20 20 6c 6f 67 28 27 53
74 61 72 74 69 6e 67 20  76 6f 69 63 65 20 63 6c
6f 6e 65 20 73 65 72 76  65 72 2e 2e 2e 27 29 3b
0d 0a 20 20 20 20 20 20  73 65 6e 64 50 72 6f 67
72 65 73 73 28 7b 20 73  74 61 74 75 73 3a 20 27
69 6e 73 74 61 6c 6c 69  6e 67 27 2c 20 70 65 72
63 65 6e 74 3a 20 39 35  2c 20 6d 65 73 73 61 67
65 3a 20 27 53 74 61 72  74 69 6e 67 20 76 6f 69
63 65 20 63 6c 6f 6e 65  20 73 65 72 76 65 72 2e
2e 2e 27 20 7d 29 3b 0d  0a 0d 0a 20 20 20 20 20
20 2f 2f 20 53 74 65 70  20 35 3a 20 53 74 61 72
74 20 74 68 65 20 50 79  74 68 6f 6e 20 73 65 72
76 65 72 0d 0a 20 20 20  20 20 20 61 77 61 69 74
20 73 74 61 72 74 56 6f  69 63 65 43 6c 6f 6e 65
53 65 72 76 65 72 28 29  3b 0d 0a 0d 0a 20 20 20
20 20 20 6c 6f 67 28 27  56 6f 69 63 65 20 63 6c
6f 6e 65 20 72 75 6e 74  69 6d 65 20 72 65 61 64
79 21 27 29 3b 0d 0a 20  20 20 20 20 20 73 65 6e
64 50 72 6f 67 72 65 73  73 28 7b 20 73 74 61 74
75 73 3a 20 27 63 6f 6d  70 6c 65 74 65 27 2c 20
70 65 72 63 65 6e 74 3a  20 31 30 30 2c 20 6d 65
73 73 61 67 65 3a 20 27  56 6f 69 63 65 20 63 6c
6f 6e 65 20 72 75 6e 74  69 6d 65 20 72 65 61 64
79 21 27 20 7d 29 3b 0d  0a 20 20 20 20 20 20 72
65 74 75 72 6e 20 7b 20  73 75 63 63 65 73 73 3a
20 74 72 75 65 20 7d 3b  0d 0a 20 20 20 20 7d 20
63 61 74 63 68 20 28 65  72 72 29 20 7b 0d 0a 20
20 20 20 20 20 6c 6f 67  28 27 45 52 52 4f 52 3a
20 27 20 2b 20 65 72 72  2e 6d 65 73 73 61 67 65
29 3b 0d 0a 20 20 20 20  20 20 63 6f 6e 73 6f 6c
65 2e 65 72 72 6f 72 28  27 5b 56 6f 69 63 65 43
6c 6f 6e 65 5d 20 53 65  74 75 70 20 66 61 69 6c
65 64 3a 27 2c 20 65 72  72 29 3b 0d 0a 20 20 20
20 20 20 73 65 6e 64 50  72 6f 67 72 65 73 73 28
7b 20 73 74 61 74 75 73  3a 20 27 65 72 72 6f 72
27 2c 20 70 65 72 63 65  6e 74 3a 20 30 2c 20 6d
65 73 73 61 67 65 3a 20  60 53 65 74 75 70 20 66
61 69 6c 65 64 3a 20 24  7b 65 72 72 2e 6d 65 73
73 61 67 65 7d 60 20 7d  29 3b 0d 0a 20 20 20 20
20 20 72 65 74 75 72 6e  20 7b 20 73 75 63 63 65
73 73 3a 20 66 61 6c 73  65 2c 20 65 72 72 6f 72
3a 20 65 72 72 2e 6d 65  73 73 61 67 65 20 7d 3b
0d 0a 20 20 20 20 7d 0d  0a 20 20 7d 29 3b 0d 0a
7d 0d 0a 0d 0a 2f 2f 20  4c 6f 6e 67 2d 72 75 6e
6e 69 6e 67 20 6f 70 65  72 61 74 69 6f 6e 73 20
74 68 61 74 20 6e 65 65  64 20 65 78 74 65 6e 64
65 64 20 74 69 6d 65 6f  75 74 20 28 35 20 6d 69
6e 75 74 65 73 29 0d 0a  63 6f 6e 73 74 20 4c 4f
4e 47 5f 52 55 4e 4e 49  4e 47 5f 4f 50 53 20 3d
20 6e 65 77 20 53 65 74  28 5b 27 64 6f 77 6e 6c
6f 61 64 2d 76 69 64 65  6f 27 2c 20 27 79 74 64
6c 70 2d 75 70 64 61 74  65 27 2c 20 27 79 74 64
6c 70 2d 69 6e 73 74 61  6c 6c 27 5d 29 3b 0d 0a
0d 0a 2f 2f 20 53 65 6e  64 20 6d 65 73 73 61 67
65 20 74 6f 20 73 65 72  76 65 72 20 61 6e 64 20
77 61 69 74 20 66 6f 72  20 72 65 70 6c 79 0d 0a
66 75 6e 63 74 69 6f 6e  20 73 65 6e 64 54 6f 53
65 72 76 65 72 28 6e 61  6d 65 2c 20 61 72 67 73
29 20 7b 0d 0a 20 20 72  65 74 75 72 6e 20 6e 65
77 20 50 72 6f 6d 69 73  65 28 28 72 65 73 6f 6c
76 65 2c 20 72 65 6a 65  63 74 29 20 3d 3e 20 7b
0d 0a 20 20 20 20 69 66  20 28 21 73 65 72 76 65
72 50 72 6f 63 65 73 73  29 20 7b 0d 0a 20 20 20
20 20 20 72 65 6a 65 63  74 28 6e 65 77 20 45 72
72 6f 72 28 27 53 65 72  76 65 72 20 6e 6f 74 20
72 75 6e 6e 69 6e 67 27  29 29 3b 0d 0a 20 20 20
20 20 20 72 65 74 75 72  6e 3b 0d 0a 20 20 20 20
7d 0d 0a 20 20 20 20 0d  0a 20 20 20 20 63 6f 6e
73 74 20 69 64 20 3d 20  2b 2b 72 65 71 75 65 73
74 49 64 3b 0d 0a 20 20  20 20 70 65 6e 64 69 6e
67 52 65 71 75 65 73 74  73 2e 73 65 74 28 69 64
2c 20 7b 20 72 65 73 6f  6c 76 65 2c 20 72 65 6a
65 63 74 20 7d 29 3b 0d  0a 20 20 20 20 0d 0a 20
20 20 20 73 65 72 76 65  72 50 72 6f 63 65 73 73
2e 73 65 6e 64 28 7b 20  74 79 70 65 3a 20 27 72
65 71 75 65 73 74 27 2c  20 69 64 2c 20 6e 61 6d
65 2c 20 61 72 67 73 20  7d 29 3b 0d 0a 20 20 20
20 0d 0a 20 20 20 20 2f  2f 20 55 73 65 20 35 20
6d 69 6e 75 74 65 20 74  69 6d 65 6f 75 74 20 66
6f 72 20 6c 6f 6e 67 2d  72 75 6e 6e 69 6e 67 20
6f 70 73 2c 20 36 30 73  20 66 6f 72 20 6f 74 68
65 72 73 0d 0a 20 20 20  20 63 6f 6e 73 74 20 74
69 6d 65 6f 75 74 20 3d  20 4c 4f 4e 47 5f 52 55
4e 4e 49 4e 47 5f 4f 50  53 2e 68 61 73 28 6e 61
6d 65 29 20 3f 20 33 30  30 30 30 30 20 3a 20 36
30 30 30 30 3b 0d 0a 20  20 20 20 73 65 74 54 69
6d 65 6f 75 74 28 28 29  20 3d 3e 20 7b 0d 0a 20
20 20 20 20 20 69 66 20  28 70 65 6e 64 69 6e 67
52 65 71 75 65 73 74 73  2e 68 61 73 28 69 64 29
29 20 7b 0d 0a 20 20 20  20 20 20 20 20 70 65 6e
64 69 6e 67 52 65 71 75  65 73 74 73 2e 64 65 6c
65 74 65 28 69 64 29 3b  0d 0a 20 20 20 20 20 20
20 20 72 65 6a 65 63 74  28 6e 65 77 20 45 72 72
6f 72 28 27 52 65 71 75  65 73 74 20 74 69 6d 65
6f 75 74 27 29 29 3b 0d  0a 20 20 20 20 20 20 7d
0d 0a 20 20 20 20 7d 2c  20 74 69 6d 65 6f 75 74
29 3b 0d 0a 20 20 7d 29  3b 0d 0a 7d 0d 0a 0d 0a
66 75 6e 63 74 69 6f 6e  20 63 72 65 61 74 65 57
69 6e 64 6f 77 28 29 20  7b 0d 0a 20 20 6d 61 69
6e 57 69 6e 64 6f 77 20  3d 20 6e 65 77 20 42 72
6f 77 73 65 72 57 69 6e  64 6f 77 28 7b 0d 0a 20
20 20 20 77 69 64 74 68  3a 20 31 34 30 30 2c 0d
0a 20 20 20 20 68 65 69  67 68 74 3a 20 39 30 30
2c 0d 0a 20 20 20 20 6d  69 6e 57 69 64 74 68 3a
20 38 30 30 2c 0d 0a 20  20 20 20 6d 69 6e 48 65
69 67 68 74 3a 20 36 30  30 2c 0d 0a 20 20 20 20
69 63 6f 6e 3a 20 70 61  74 68 2e 6a 6f 69 6e 28
67 65 74 50 72 6f 6a 65  63 74 52 6f 6f 74 28 29
2c 20 27 63 6c 69 65 6e  74 27 2c 20 27 70 75 62
6c 69 63 27 2c 20 27 66  61 76 69 63 6f 6e 2e 70
6e 67 27 29 2c 0d 0a 20  20 20 20 77 65 62 50 72
65 66 65 72 65 6e 63 65  73 3a 20 7b 0d 0a 20 20
20 20 20 20 6e 6f 64 65  49 6e 74 65 67 72 61 74
69 6f 6e 3a 20 66 61 6c  73 65 2c 0d 0a 20 20 20
20 20 20 63 6f 6e 74 65  78 74 49 73 6f 6c 61 74
69 6f 6e 3a 20 74 72 75  65 2c 0d 0a 20 20 20 20
20 20 73 61 6e 64 62 6f  78 3a 20 66 61 6c 73 65
2c 0d 0a 20 20 20 20 20  20 70 72 65 6c 6f 61 64
3a 20 70 61 74 68 2e 6a  6f 69 6e 28 5f 5f 64 69
72 6e 61 6d 65 2c 20 27  70 72 65 6c 6f 61 64 2e
63 6a 73 27 29 2c 0d 0a  20 20 20 20 7d 2c 0d 0a
20 20 20 20 74 69 74 6c  65 3a 20 27 41 49 20 43
6f 6e 74 65 6e 74 20 48  75 62 27 2c 0d 0a 20 20
20 20 73 68 6f 77 3a 20  66 61 6c 73 65 2c 0d 0a
20 20 7d 29 3b 0d 0a 0d  0a 20 20 6d 61 69 6e 57
69 6e 64 6f 77 2e 6f 6e  63 65 28 27 72 65 61 64
79 2d 74 6f 2d 73 68 6f  77 27 2c 20 28 29 20 3d
3e 20 7b 0d 0a 20 20 20  20 6d 61 69 6e 57 69 6e
64 6f 77 2e 73 68 6f 77  28 29 3b 0d 0a 20 20 7d
29 3b 0d 0a 0d 0a 20 20  2f 2f 20 4c 6f 61 64 20
74 68 65 20 63 6c 69 65  6e 74 20 48 54 4d 4c 0d
0a 20 20 69 66 20 28 69  73 44 65 76 29 20 7b 0d
0a 20 20 20 20 6d 61 69  6e 57 69 6e 64 6f 77 2e
6c 6f 61 64 55 52 4c 28  27 68 74 74 70 3a 2f 2f
6c 6f 63 61 6c 68 6f 73  74 3a 35 30 30 30 27 29
3b 0d 0a 20 20 20 20 6d  61 69 6e 57 69 6e 64 6f
77 2e 77 65 62 43 6f 6e  74 65 6e 74 73 2e 6f 70
65 6e 44 65 76 54 6f 6f  6c 73 28 29 3b 0d 0a 20
20 7d 20 65 6c 73 65 20  7b 0d 0a 20 20 20 20 2f
2f 20 49 6e 20 70 72 6f  64 75 63 74 69 6f 6e 2c
20 6c 6f 61 64 20 66 72  6f 6d 20 62 75 6e 64 6c
65 64 20 66 69 6c 65 73  0d 0a 20 20 20 20 63 6f
6e 73 74 20 69 6e 64 65  78 50 61 74 68 20 3d 20
70 61 74 68 2e 6a 6f 69  6e 28 61 70 70 2e 67 65
74 41 70 70 50 61 74 68  28 29 2c 20 27 64 69 73
74 27 2c 20 27 70 75 62  6c 69 63 27 2c 20 27 69
6e 64 65 78 2e 68 74 6d  6c 27 29 3b 0d 0a 20 20
20 20 63 6f 6e 73 6f 6c  65 2e 6c 6f 67 28 27 4c
6f 61 64 69 6e 67 3a 27  2c 20 69 6e 64 65 78 50
61 74 68 29 3b 0d 0a 20  20 20 20 63 6f 6e 73 6f
6c 65 2e 6c 6f 67 28 27  45 78 69 73 74 73 3a 27
2c 20 66 73 2e 65 78 69  73 74 73 53 79 6e 63 28
69 6e 64 65 78 50 61 74  68 29 29 3b 0d 0a 20 20
20 20 0d 0a 20 20 20 20  69 66 20 28 66 73 2e 65
78 69 73 74 73 53 79 6e  63 28 69 6e 64 65 78 50
61 74 68 29 29 20 7b 0d  0a 20 20 20 20 20 20 6d
61 69 6e 57 69 6e 64 6f  77 2e 6c 6f 61 64 46 69
6c 65 28 69 6e 64 65 78  50 61 74 68 29 3b 0d 0a
20 20 20 20 7d 20 65 6c  73 65 20 7b 0d 0a 20 20
20 20 20 20 2f 2f 20 54  72 79 20 61 6c 74 65 72
6e 61 74 69 76 65 20 70  61 74 68 0d 0a 20 20 20
20 20 20 63 6f 6e 73 74  20 61 6c 74 50 61 74 68
20 3d 20 70 61 74 68 2e  6a 6f 69 6e 28 5f 5f 64
69 72 6e 61 6d 65 2c 20  27 2e 2e 27 2c 20 27 64
69 73 74 27 2c 20 27 70  75 62 6c 69 63 27 2c 20
27 69 6e 64 65 78 2e 68  74 6d 6c 27 29 3b 0d 0a
20 20 20 20 20 20 63 6f  6e 73 6f 6c 65 2e 6c 6f
67 28 27 54 72 79 69 6e  67 20 61 6c 74 20 70 61
74 68 3a 27 2c 20 61 6c  74 50 61 74 68 29 3b 0d
0a 20 20 20 20 20 20 69  66 20 28 66 73 2e 65 78
69 73 74 73 53 79 6e 63  28 61 6c 74 50 61 74 68
29 29 20 7b 0d 0a 20 20  20 20 20 20 20 20 6d 61
69 6e 57 69 6e 64 6f 77  2e 6c 6f 61 64 46 69 6c
65 28 61 6c 74 50 61 74  68 29 3b 0d 0a 20 20 20
20 20 20 7d 20 65 6c 73  65 20 7b 0d 0a 20 20 20
20 20 20 20 20 6d 61 69  6e 57 69 6e 64 6f 77 2e
6c 6f 61 64 55 52 4c 28  60 64 61 74 61 3a 74 65
78 74 2f 68 74 6d 6c 2c  3c 68 31 3e 45 72 72 6f
72 3a 20 43 6f 75 6c 64  20 6e 6f 74 20 66 69 6e
64 20 69 6e 64 65 78 2e  68 74 6d 6c 3c 2f 68 31
3e 3c 70 3e 43 68 65 63  6b 65 64 3a 20 24 7b 69
6e 64 65 78 50 61 74 68  7d 3c 2f 70 3e 3c 70 3e
41 6e 64 3a 20 24 7b 61  6c 74 50 61 74 68 7d 3c
2f 70 3e 60 29 3b 0d 0a  20 20 20 20 20 20 7d 0d
0a 20 20 20 20 7d 0d 0a  20 20 7d 0d 0a 0d 0a 20
20 6d 61 69 6e 57 69 6e  64 6f 77 2e 77 65 62 43
6f 6e 74 65 6e 74 73 2e  6f 6e 28 27 64 69 64 2d
66 61 69 6c 2d 6c 6f 61  64 27 2c 20 28 65 76 65
6e 74 2c 20 65 72 72 6f  72 43 6f 64 65 2c 20 65
72 72 6f 72 44 65 73 63  72 69 70 74 69 6f 6e 29
20 3d 3e 20 7b 0d 0a 20  20 20 20 63 6f 6e 73 6f
6c 65 2e 65 72 72 6f 72  28 27 4c 6f 61 64 20 66
61 69 6c 65 64 3a 27 2c  20 65 72 72 6f 72 43 6f
64 65 2c 20 65 72 72 6f  72 44 65 73 63 72 69 70
74 69 6f 6e 29 3b 0d 0a  20 20 7d 29 3b 0d 0a 0d
0a 20 20 2f 2f 20 50 72  65 76 65 6e 74 20 74 68
65 20 6d 61 69 6e 20 77  69 6e 64 6f 77 20 66 72
6f 6d 20 6e 61 76 69 67  61 74 69 6e 67 20 61 77
61 79 20 28 65 2e 67 2e  20 69 66 72 61 6d 65 20
63 6f 6e 74 65 6e 74 20  74 72 69 67 67 65 72 69
6e 67 20 74 6f 70 2d 6c  65 76 65 6c 20 6e 61 76
69 67 61 74 69 6f 6e 29  0d 0a 20 20 6d 61 69 6e
57 69 6e 64 6f 77 2e 77  65 62 43 6f 6e 74 65 6e
74 73 2e 6f 6e 28 27 77  69 6c 6c 2d 6e 61 76 69
67 61 74 65 27 2c 20 28  65 76 65 6e 74 2c 20 75
72 6c 29 20 3d 3e 20 7b  0d 0a 20 20 20 20 63 6f
6e 73 74 20 61 70 70 4f  72 69 67 69 6e 20 3d 20
69 73 44 65 76 20 3f 20  27 68 74 74 70 3a 2f 2f
6c 6f 63 61 6c 68 6f 73  74 3a 35 30 30 30 27 20
3a 20 27 66 69 6c 65 3a  2f 2f 27 3b 0d 0a 20 20
20 20 69 66 20 28 21 75  72 6c 2e 73 74 61 72 74
73 57 69 74 68 28 61 70  70 4f 72 69 67 69 6e 29
29 20 7b 0d 0a 20 20 20  20 20 20 65 76 65 6e 74
2e 70 72 65 76 65 6e 74  44 65 66 61 75 6c 74 28
29 3b 0d 0a 20 20 20 20  7d 0d 0a 20 20 7d 29 3b
0d 0a 0d 0a 20 20 6d 61  69 6e 57 69 6e 64 6f 77
2e 77 65 62 43 6f 6e 74  65 6e 74 73 2e 73 65 74
57 69 6e 64 6f 77 4f 70  65 6e 48 61 6e 64 6c 65
72 28 28 7b 20 75 72 6c  20 7d 29 20 3d 3e 20 7b
0d 0a 20 20 20 20 73 68  65 6c 6c 2e 6f 70 65 6e
45 78 74 65 72 6e 61 6c  28 75 72 6c 29 3b 0d 0a
20 20 20 20 72 65 74 75  72 6e 20 7b 20 61 63 74
69 6f 6e 3a 20 27 64 65  6e 79 27 20 7d 3b 0d 0a
20 20 7d 29 3b 0d 0a 0d  0a 20 20 6d 61 69 6e 57
69 6e 64 6f 77 2e 6f 6e  28 27 63 6c 6f 73 65 64
27 2c 20 28 29 20 3d 3e  20 7b 0d 0a 20 20 20 20
6d 61 69 6e 57 69 6e 64  6f 77 20 3d 20 6e 75 6c
6c 3b 0d 0a 20 20 7d 29  3b 0d 0a 7d 0d 0a 0d 0a
66 75 6e 63 74 69 6f 6e  20 73 74 61 72 74 53 65
72 76 65 72 28 29 20 7b  0d 0a 20 20 63 6f 6e 73
74 20 73 65 72 76 65 72  50 61 74 68 20 3d 20 70
61 74 68 2e 6a 6f 69 6e  28 5f 5f 64 69 72 6e 61
6d 65 2c 20 27 73 65 72  76 65 72 2e 63 6a 73 27
29 3b 0d 0a 20 20 63 6f  6e 73 6f 6c 65 2e 6c 6f
67 28 27 53 74 61 72 74  69 6e 67 20 73 65 72 76
65 72 3a 27 2c 20 73 65  72 76 65 72 50 61 74 68
29 3b 0d 0a 20 20 0d 0a  20 20 73 65 72 76 65 72
50 72 6f 63 65 73 73 20  3d 20 66 6f 72 6b 28 73
65 72 76 65 72 50 61 74  68 2c 20 5b 5d 2c 20 7b
0d 0a 20 20 20 20 73 74  64 69 6f 3a 20 5b 27 70
69 70 65 27 2c 20 27 70  69 70 65 27 2c 20 27 70
69 70 65 27 2c 20 27 69  70 63 27 5d 0d 0a 20 20
7d 29 3b 0d 0a 0d 0a 20  20 73 65 72 76 65 72 50
72 6f 63 65 73 73 2e 73  74 64 6f 75 74 2e 6f 6e
28 27 64 61 74 61 27 2c  20 28 64 61 74 61 29 20
3d 3e 20 7b 0d 0a 20 20  20 20 63 6f 6e 73 6f 6c
65 2e 6c 6f 67 28 27 5b  53 65 72 76 65 72 5d 27
2c 20 64 61 74 61 2e 74  6f 53 74 72 69 6e 67 28
29 2e 74 72 69 6d 28 29  29 3b 0d 0a 20 20 7d 29
3b 0d 0a 0d 0a 20 20 73  65 72 76 65 72 50 72 6f
63 65 73 73 2e 73 74 64  65 72 72 2e 6f 6e 28 27
64 61 74 61 27 2c 20 28  64 61 74 61 29 20 3d 3e
20 7b 0d 0a 20 20 20 20  63 6f 6e 73 6f 6c 65 2e
65 72 72 6f 72 28 27 5b  53 65 72 76 65 72 20 45
72 72 6f 72 5d 27 2c 20  64 61 74 61 2e 74 6f 53
74 72 69 6e 67 28 29 2e  74 72 69 6d 28 29 29 3b
0d 0a 20 20 7d 29 3b 0d  0a 0d 0a 20 20 2f 2f 20
48 61 6e 64 6c 65 20 6d  65 73 73 61 67 65 73 20
66 72 6f 6d 20 73 65 72  76 65 72 0d 0a 20 20 73
65 72 76 65 72 50 72 6f  63 65 73 73 2e 6f 6e 28
27 6d 65 73 73 61 67 65  27 2c 20 28 6d 73 67 29
20 3d 3e 20 7b 0d 0a 20  20 20 20 69 66 20 28 6d
73 67 2e 74 79 70 65 20  3d 3d 3d 20 27 72 65 70
6c 79 27 29 20 7b 0d 0a  20 20 20 20 20 20 63 6f
6e 73 74 20 70 65 6e 64  69 6e 67 20 3d 20 70 65
6e 64 69 6e 67 52 65 71  75 65 73 74 73 2e 67 65
74 28 6d 73 67 2e 69 64  29 3b 0d 0a 20 20 20 20
20 20 69 66 20 28 70 65  6e 64 69 6e 67 29 20 7b
0d 0a 20 20 20 20 20 20  20 20 70 65 6e 64 69 6e
67 52 65 71 75 65 73 74  73 2e 64 65 6c 65 74 65
28 6d 73 67 2e 69 64 29  3b 0d 0a 20 20 20 20 20
20 20 20 69 66 20 28 6d  73 67 2e 65 72 72 6f 72
29 20 7b 0d 0a 20 20 20  20 20 20 20 20 20 20 70
65 6e 64 69 6e 67 2e 72  65 6a 65 63 74 28 6e 65
77 20 45 72 72 6f 72 28  6d 73 67 2e 65 72 72 6f
72 29 29 3b 0d 0a 20 20  20 20 20 20 20 20 7d 20
65 6c 73 65 20 7b 0d 0a  20 20 20 20 20 20 20 20
20 20 70 65 6e 64 69 6e  67 2e 72 65 73 6f 6c 76
65 28 6d 73 67 2e 72 65  73 75 6c 74 29 3b 0d 0a
20 20 20 20 20 20 20 20  7d 0d 0a 20 20 20 20 20
20 7d 0d 0a 20 20 20 20  7d 20 65 6c 73 65 20 69
66 20 28 6d 73 67 2e 74  79 70 65 20 3d 3d 3d 20
27 70 75 73 68 27 29 20  7b 0d 0a 20 20 20 20 20
20 2f 2f 20 46 6f 72 77  61 72 64 20 70 75 73 68
20 6d 65 73 73 61 67 65  73 20 74 6f 20 72 65 6e
64 65 72 65 72 0d 0a 20  20 20 20 20 20 69 66 20
28 6d 61 69 6e 57 69 6e  64 6f 77 20 26 26 20 21
6d 61 69 6e 57 69 6e 64  6f 77 2e 69 73 44 65 73
74 72 6f 79 65 64 28 29  29 20 7b 0d 0a 20 20 20
20 20 20 20 20 6d 61 69  6e 57 69 6e 64 6f 77 2e
77 65 62 43 6f 6e 74 65  6e 74 73 2e 73 65 6e 64
28 27 73 65 72 76 65 72  3a 70 75 73 68 27 2c 20
6d 73 67 2e 64 61 74 61  29 3b 0d 0a 20 20 20 20
20 20 7d 0d 0a 20 20 20  20 7d 0d 0a 20 20 7d 29
3b 0d 0a 0d 0a 20 20 73  65 72 76 65 72 50 72 6f
63 65 73 73 2e 6f 6e 28  27 65 72 72 6f 72 27 2c
20 28 65 72 72 29 20 3d  3e 20 7b 0d 0a 20 20 20
20 63 6f 6e 73 6f 6c 65  2e 65 72 72 6f 72 28 27
53 65 72 76 65 72 20 70  72 6f 63 65 73 73 20 65
72 72 6f 72 3a 27 2c 20  65 72 72 29 3b 0d 0a 20
20 7d 29 3b 0d 0a 0d 0a  20 20 73 65 72 76 65 72
50 72 6f 63 65 73 73 2e  6f 6e 28 27 65 78 69 74
27 2c 20 28 63 6f 64 65  2c 20 73 69 67 6e 61 6c
29 20 3d 3e 20 7b 0d 0a  20 20 20 20 63 6f 6e 73
6f 6c 65 2e 6c 6f 67 28  27 53 65 72 76 65 72 20
70 72 6f 63 65 73 73 20  65 78 69 74 65 64 3a 27
2c 20 63 6f 64 65 2c 20  73 69 67 6e 61 6c 29 3b
0d 0a 20 20 20 20 73 65  72 76 65 72 50 72 6f 63
65 73 73 20 3d 20 6e 75  6c 6c 3b 0d 0a 20 20 7d
29 3b 0d 0a 7d 0d 0a 0d  0a 61 70 70 2e 77 68 65
6e 52 65 61 64 79 28 29  2e 74 68 65 6e 28 61 73
79 6e 63 20 28 29 20 3d  3e 20 7b 0d 0a 20 20 63
6f 6e 73 6f 6c 65 2e 6c  6f 67 28 27 41 70 70 20
72 65 61 64 79 2c 20 69  73 44 65 76 3a 27 2c 20
69 73 44 65 76 29 3b 0d  0a 20 20 63 6f 6e 73 6f
6c 65 2e 6c 6f 67 28 27  41 70 70 20 70 61 74 68
3a 27 2c 20 61 70 70 2e  67 65 74 41 70 70 50 61
74 68 28 29 29 3b 0d 0a  20 20 69 6e 69 74 69 61
6c 69 7a 65 4d 61 6e 61  67 65 64 53 65 72 76 69
63 65 73 53 74 61 74 65  28 29 3b 0d 0a 20 20 0d
0a 20 20 2f 2f 20 53 65  74 75 70 20 49 50 43 20
68 61 6e 64 6c 65 72 73  0d 0a 20 20 73 65 74 75
70 49 70 63 48 61 6e 64  6c 65 72 73 28 29 3b 0d
0a 20 20 0d 0a 20 20 2f  2f 20 53 74 61 72 74 20
74 68 65 20 73 65 72 76  65 72 20 70 72 6f 63 65
73 73 0d 0a 20 20 73 74  61 72 74 53 65 72 76 65
72 28 29 3b 0d 0a 20 20  0d 0a 20 20 2f 2f 20 57
61 69 74 20 61 20 62 69  74 20 66 6f 72 20 73 65
72 76 65 72 20 74 6f 20  69 6e 69 74 69 61 6c 69
7a 65 0d 0a 20 20 61 77  61 69 74 20 6e 65 77 20
50 72 6f 6d 69 73 65 28  72 20 3d 3e 20 73 65 74
54 69 6d 65 6f 75 74 28  72 2c 20 35 30 30 29 29
3b 0d 0a 20 20 0d 0a 20  20 2f 2f 20 43 72 65 61
74 65 20 74 68 65 20 6d  61 69 6e 20 77 69 6e 64
6f 77 0d 0a 20 20 63 72  65 61 74 65 57 69 6e 64
6f 77 28 29 3b 0d 0a 20  20 62 72 6f 61 64 63 61
73 74 4d 61 6e 61 67 65  64 53 65 72 76 69 63 65
73 53 74 61 74 75 73 28  29 3b 0d 0a 0d 0a 20 20
61 70 70 2e 6f 6e 28 27  61 63 74 69 76 61 74 65
27 2c 20 28 29 20 3d 3e  20 7b 0d 0a 20 20 20 20
69 66 20 28 42 72 6f 77  73 65 72 57 69 6e 64 6f
77 2e 67 65 74 41 6c 6c  57 69 6e 64 6f 77 73 28
29 2e 6c 65 6e 67 74 68  20 3d 3d 3d 20 30 29 20
7b 0d 0a 20 20 20 20 20  20 63 72 65 61 74 65 57
69 6e 64 6f 77 28 29 3b  0d 0a 20 20 20 20 7d 0d
0a 20 20 7d 29 3b 0d 0a  7d 29 3b 0d 0a 0d 0a 61
70 70 2e 6f 6e 28 27 77  69 6e 64 6f 77 2d 61 6c
6c 2d 63 6c 6f 73 65 64  27 2c 20 28 29 20 3d 3e
20 7b 0d 0a 20 20 69 66  20 28 70 72 6f 63 65 73
73 2e 70 6c 61 74 66 6f  72 6d 20 21 3d 3d 20 27
64 61 72 77 69 6e 27 29  20 7b 0d 0a 20 20 20 20
61 70 70 2e 71 75 69 74  28 29 3b 0d 0a 20 20 7d
0d 0a 7d 29 3b 0d 0a 0d  0a 61 70 70 2e 6f 6e 28
27 62 65 66 6f 72 65 2d  71 75 69 74 27 2c 20 28
29 20 3d 3e 20 7b 0d 0a  20 20 69 66 20 28 73 65
72 76 65 72 50 72 6f 63  65 73 73 29 20 7b 0d 0a
20 20 20 20 63 6f 6e 73  6f 6c 65 2e 6c 6f 67 28
27 4b 69 6c 6c 69 6e 67  20 73 65 72 76 65 72 20
70 72 6f 63 65 73 73 27  29 3b 0d 0a 20 20 20 20
73 65 72 76 65 72 50 72  6f 63 65 73 73 2e 6b 69
6c 6c 28 29 3b 0d 0a 20  20 20 20 73 65 72 76 65
72 50 72 6f 63 65 73 73  20 3d 20 6e 75 6c 6c 3b
0d 0a 20 20 7d 0d 0a 20  20 69 66 20 28 76 6f 69
63 65 43 6c 6f 6e 65 53  65 72 76 65 72 50 72 6f
63 65 73 73 29 20 7b 0d  0a 20 20 20 20 63 6f 6e
73 6f 6c 65 2e 6c 6f 67  28 27 4b 69 6c 6c 69 6e
67 20 56 6f 69 63 65 20  43 6c 6f 6e 65 20 73 65
72 76 65 72 20 70 72 6f  63 65 73 73 27 29 3b 0d
0a 20 20 20 20 76 6f 69  63 65 43 6c 6f 6e 65 53
65 72 76 65 72 50 72 6f  63 65 73 73 2e 6b 69 6c
6c 28 29 3b 0d 0a 20 20  20 20 76 6f 69 63 65 43
6c 6f 6e 65 53 65 72 76  65 72 50 72 6f 63 65 73
73 20 3d 20 6e 75 6c 6c  3b 0d 0a 20 20 7d 0d 0a
20 20 69 66 20 28 74 74  73 46 61 73 74 53 65 72
76 65 72 50 72 6f 63 65  73 73 29 20 7b 0d 0a 20
20 20 20 63 6f 6e 73 6f  6c 65 2e 6c 6f 67 28 27
4b 69 6c 6c 69 6e 67 20  46 61 73 74 20 54 54 53
20 73 65 72 76 65 72 20  70 72 6f 63 65 73 73 27
29 3b 0d 0a 20 20 20 20  74 74 73 46 61 73 74 53
65 72 76 65 72 50 72 6f  63 65 73 73 2e 6b 69 6c
6c 28 29 3b 0d 0a 20 20  20 20 74 74 73 46 61 73
74 53 65 72 76 65 72 50  72 6f 63 65 73 73 20 3d
20 6e 75 6c 6c 3b 0d 0a  20 20 7d 0d 0a 0d 0a 20
20 66 6f 72 20 28 63 6f  6e 73 74 20 5b 73 65 72
76 69 63 65 49 64 2c 20  70 72 6f 63 65 73 73 48
61 6e 64 6c 65 5d 20 6f  66 20 6d 61 6e 61 67 65
64 53 65 72 76 69 63 65  50 72 6f 63 65 73 73 65
73 2e 65 6e 74 72 69 65  73 28 29 29 20 7b 0d 0a
20 20 20 20 63 6f 6e 73  6f 6c 65 2e 6c 6f 67 28
60 4b 69 6c 6c 69 6e 67  20 6d 61 6e 61 67 65 64
20 73 65 72 76 69 63 65  20 70 72 6f 63 65 73 73
3a 20 24 7b 73 65 72 76  69 63 65 49 64 7d 60 29
3b 0d 0a 20 20 20 20 74  72 79 20 7b 0d 0a 20 20
20 20 20 20 70 72 6f 63  65 73 73 48 61 6e 64 6c
65 2e 6b 69 6c 6c 28 29  3b 0d 0a 20 20 20 20 7d
20 63 61 74 63 68 20 28  65 72 72 6f 72 29 20 7b
0d 0a 20 20 20 20 20 20  63 6f 6e 73 6f 6c 65 2e
65 72 72 6f 72 28 60 46  61 69 6c 65 64 20 74 6f
20 6b 69 6c 6c 20 6d 61  6e 61 67 65 64 20 73 65
72 76 69 63 65 20 24 7b  73 65 72 76 69 63 65 49
64 7d 3a 60 2c 20 65 72  72 6f 72 29 3b 0d 0a 20
20 20 20 7d 0d 0a 20 20  7d 0d 0a 20 20 6d 61 6e
61 67 65 64 53 65 72 76  69 63 65 50 72 6f 63 65
73 73 65 73 2e 63 6c 65  61 72 28 29 3b 0d 0a 7d
29 3b 0d 0a 0d 0a 70 72  6f 63 65 73 73 2e 6f 6e
28 27 75 6e 63 61 75 67  68 74 45 78 63 65 70 74
69 6f 6e 27 2c 20 28 65  72 72 29 20 3d 3e 20 7b
0d 0a 20 20 63 6f 6e 73  6f 6c 65 2e 65 72 72 6f
72 28 27 55 6e 63 61 75  67 68 74 20 65 78 63 65
70 74 69 6f 6e 3a 27 2c  20 65 72 72 29 3b 0d 0a
7d 29 3b 0d 0a 0d 0a 70  72 6f 63 65 73 73 2e 6f
6e 28 27 75 6e 68 61 6e  64 6c 65 64 52 65 6a 65
63 74 69 6f 6e 27 2c 20  28 72 65 61 73 6f 6e 29
20 3d 3e 20 7b 0d 0a 20  20 63 6f 6e 73 6f 6c 65
2e 65 72 72 6f 72 28 27  55 6e 68 61 6e 64 6c 65
64 20 72 65 6a 65 63 74  69 6f 6e 3a 27 2c 20 72
65 61 73 6f 6e 29 3b 0d  0a 7d 29 3b 0d 0a
